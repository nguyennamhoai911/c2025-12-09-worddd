Directory structure:
‚îî‚îÄ‚îÄ c2025-12-09-full-app-english/
    ‚îú‚îÄ‚îÄ AI_CONTEXT.md
    ‚îú‚îÄ‚îÄ digest_now-use.txt
    ‚îú‚îÄ‚îÄ docker-compose.yml
    ‚îî‚îÄ‚îÄ apps/
        ‚îú‚îÄ‚îÄ extension.crx
        ‚îú‚îÄ‚îÄ extension.pem
        ‚îú‚îÄ‚îÄ tree.txt
        ‚îú‚îÄ‚îÄ backend/
        ‚îÇ   ‚îú‚îÄ‚îÄ README.md
        ‚îÇ   ‚îú‚îÄ‚îÄ eslint.config.mjs
        ‚îÇ   ‚îú‚îÄ‚îÄ nest-cli.json
        ‚îÇ   ‚îú‚îÄ‚îÄ package.json
        ‚îÇ   ‚îú‚îÄ‚îÄ tree.txt
        ‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.build.json
        ‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
        ‚îÇ   ‚îú‚îÄ‚îÄ .prettierrc
        ‚îÇ   ‚îú‚îÄ‚îÄ prisma/
        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma
        ‚îÇ   ‚îú‚îÄ‚îÄ src/
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.controller.spec.ts
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.controller.ts
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.service.ts
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.ts
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.controller.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.module.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.service.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create-auth.dto.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ update-auth.dto.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.entity.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ google-auth.guard.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt-auth.guard.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ local-auth.guard.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ strategies/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ google.strategy.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ jwt.strategy.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ local.strategy.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.controller.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.module.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.service.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create-user.dto.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ update-user.dto.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ entities/
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ user.entity.ts
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vocabulary/
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vocabulary.controller.ts
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vocabulary.module.ts
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ vocabulary.service.ts
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ dto/
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ create-vocabulary.dto.ts
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ update-vocabulary.dto.ts
        ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ entities/
        ‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ vocabulary.entity.ts
        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prisma/
        ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ prisma.module.ts
        ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ prisma.service.ts
        ‚îÇ   ‚îî‚îÄ‚îÄ test/
        ‚îÇ       ‚îú‚îÄ‚îÄ app.e2e-spec.ts
        ‚îÇ       ‚îî‚îÄ‚îÄ jest-e2e.json
        ‚îú‚îÄ‚îÄ extension/
        ‚îÇ   ‚îú‚îÄ‚îÄ background.js
        ‚îÇ   ‚îú‚îÄ‚îÄ content.js
        ‚îÇ   ‚îú‚îÄ‚îÄ manifest.json
        ‚îÇ   ‚îú‚îÄ‚îÄ popup.css
        ‚îÇ   ‚îú‚îÄ‚îÄ popup.html
        ‚îÇ   ‚îú‚îÄ‚îÄ popup.js
        ‚îÇ   ‚îî‚îÄ‚îÄ content-scripts/
        ‚îÇ       ‚îú‚îÄ‚îÄ main.js
        ‚îÇ       ‚îú‚îÄ‚îÄ messager.js
        ‚îÇ       ‚îú‚îÄ‚îÄ shortcuts.js
        ‚îÇ       ‚îî‚îÄ‚îÄ ui.js
        ‚îî‚îÄ‚îÄ frontend/
            ‚îú‚îÄ‚îÄ README.md
            ‚îú‚îÄ‚îÄ eslint.config.mjs
            ‚îú‚îÄ‚îÄ next.config.ts
            ‚îú‚îÄ‚îÄ package.json
            ‚îú‚îÄ‚îÄ postcss.config.js
            ‚îú‚îÄ‚îÄ postcss.config.mjs
            ‚îú‚îÄ‚îÄ tailwind.config.ts
            ‚îú‚îÄ‚îÄ tsconfig.json
            ‚îú‚îÄ‚îÄ app/
            ‚îÇ   ‚îú‚îÄ‚îÄ globals.css
            ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
            ‚îÇ   ‚îú‚îÄ‚îÄ page.module.css
            ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
            ‚îÇ   ‚îú‚îÄ‚îÄ admin/
            ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users/
            ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx
            ‚îÇ   ‚îú‚îÄ‚îÄ app/
            ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth/
            ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ callback/
            ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ page.tsx
            ‚îÇ   ‚îú‚îÄ‚îÄ login/
            ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
            ‚îÇ   ‚îú‚îÄ‚îÄ register/
            ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
            ‚îÇ   ‚îî‚îÄ‚îÄ vocabulary/
            ‚îÇ       ‚îú‚îÄ‚îÄ page.tsx
            ‚îÇ       ‚îî‚îÄ‚îÄ tree.txt
            ‚îú‚îÄ‚îÄ components/
            ‚îÇ   ‚îú‚îÄ‚îÄ Icons.tsx
            ‚îÇ   ‚îî‚îÄ‚îÄ vocabulary/
            ‚îÇ       ‚îú‚îÄ‚îÄ AssessmentModal.tsx
            ‚îÇ       ‚îú‚îÄ‚îÄ QuickSearchModal.tsx
            ‚îÇ       ‚îú‚îÄ‚îÄ VocabFormModal.tsx
            ‚îÇ       ‚îî‚îÄ‚îÄ VocabTable.tsx
            ‚îî‚îÄ‚îÄ contexts/
                ‚îî‚îÄ‚îÄ AuthContext.tsx

================================================
FILE: AI_CONTEXT.md
================================================
[Empty file]


================================================
FILE: digest_now-use.txt
================================================
[Binary file]


================================================
FILE: docker-compose.yml
================================================
# c2025-12-09-full-app-english\docker-compose.yml

# --- PH·∫¶N 1: GLOBAL SETTINGS (C√ÄI ƒê·∫∂T CHUNG) ---

# Version: X√°c ƒë·ªãnh 'grammar' (ng·ªØ ph√°p) m√† file n√†y s·ª≠ d·ª•ng.
# Version 3.8 l√† b·∫£n stable (·ªïn ƒë·ªãnh) v√† ph·ªï bi·∫øn nh·∫•t hi·ªán nay.
version: "3.8"

# --- PH·∫¶N 2: SERVICES (C√ÅC ·ª®NG D·ª§NG C·∫¶N CH·∫†Y) ---
# Services l√† tr√°i tim c·ªßa file. N∆°i b·∫°n list ra c√°c 'app' mu·ªën ch·∫°y.
services:
  # === SERVICE 1: DATABASE (POSTGRESQL) ===
  postgres:
    # 1. Image (Source Code):
    # - 'postgres': T√™n ph·∫ßn m·ªÅm tr√™n Docker Hub.
    # - ':15-alpine': Tag phi√™n b·∫£n.
    #   + '15': Version ch√≠nh.
    #   + 'alpine': L√† h·ªá ƒëi·ªÅu h√†nh Linux si√™u nh·ªè (ch·ªâ ~5MB), gi√∫p container nh·∫π v√† b·∫£o m·∫≠t h∆°n.
    image: postgres:15-alpine

    # 2. Container Name (ƒê·ªãnh danh):
    # - N·∫øu kh√¥ng ƒë·∫∑t, Docker s·∫Ω t·ª± random t√™n (vd: project_postgres_1).
    # - ƒê·∫∑t t√™n c·ªë ƒë·ªãnh 'vocab_db' gi√∫p b·∫°n d·ªÖ g√µ l·ªánh (CLI) sau n√†y.
    container_name: vocab_db

    # 3. Environment Variables (Bi·∫øn m√¥i tr∆∞·ªùng):
    # - ƒê√¢y l√† c√°ch ta 'inject' (ti√™m) c·∫•u h√¨nh v√†o trong container l√∫c n√≥ kh·ªüi ƒë·ªông (runtime).
    # - C√°c bi·∫øn b·∫Øt ƒë·∫ßu b·∫±ng 'POSTGRES_...' l√† quy ƒë·ªãnh ri√™ng c·ªßa image Postgres.
    environment:
      POSTGRES_USER: myuser # T·∫°o user m·∫∑c ƒë·ªãnh c√≥ quy·ªÅn cao nh·∫•t (superuser)
      POSTGRES_PASSWORD: mypassword # Set m·∫≠t kh·∫©u cho user ƒë√≥
      POSTGRES_DB: vocab_db # T·ª± ƒë·ªông t·∫°o s·∫µn 1 database r·ªóng t√™n l√† 'vocab_db'

    # 4. Ports Mapping (√Ånh x·∫° c·ªïng - Quan tr·ªçng!):
    # - C√∫ ph√°p: "HOST_PORT : CONTAINER_PORT" (Ngo√†i : Trong).
    # - "5432" (Tr√°i): C·ªïng tr√™n m√°y t√≠nh c·ªßa b·∫°n (Localhost).
    # - "5432" (Ph·∫£i): C·ªïng m·∫∑c ƒë·ªãnh m√† Postgres l·∫Øng nghe b√™n trong container.
    # -> √ù nghƒ©a: B·∫•t c·ª© ai g√µ v√†o 'localhost:5432' tr√™n m√°y b·∫°n s·∫Ω ƒë∆∞·ª£c 'tunnel' (ƒëi ƒë∆∞·ªùng h·∫ßm) th·∫≥ng v√†o database.
    ports:
      - "5433:5432"  # üëà S·ª≠a 5432 th√†nh 5433 (C·ªïng ngo√†i m√°y th·∫≠t : C·ªïng trong docker)

    # 5. Volumes (L∆∞u tr·ªØ d·ªØ li·ªáu):
    # - C√∫ ph√°p: "VOLUME_NAME : CONTAINER_PATH"
    # - 'postgres_data': T√™n c√°i 'k√©t s·∫Øt' (volume) do Docker qu·∫£n l√Ω.
    # - '/var/lib/postgresql/data': ƒê∆∞·ªùng d·∫´n b·∫Øt bu·ªôc n∆°i Postgres l∆∞u file d·ªØ li·ªáu b√™n trong.
    # -> √ù nghƒ©a: Sync (ƒë·ªìng b·ªô) d·ªØ li·ªáu t·ª´ trong ra ngo√†i. Container ch·∫øt, data v·∫´n c√≤n ·ªü 'postgres_data'.
    volumes:
      - postgres_data:/var/lib/postgresql/data

    # 6. Restart Policy (C∆° ch·∫ø t·ª± ph·ª•c h·ªìi):
    # - 'always': N·∫øu container b·ªã crash (l·ªói) ho·∫∑c m√°y t√≠nh kh·ªüi ƒë·ªông l·∫°i,
    #   Docker s·∫Ω t·ª± ƒë·ªông b·∫≠t n√≥ d·∫≠y. Gi·ªØ cho service lu√¥n 'Alive'.
    restart: always

  # === SERVICE 2: REDIS (CACHE / QUEUE) ===
  redis:
    # D√πng image redis b·∫£n nh·∫π nh·∫•t (alpine)
    image: redis:alpine

    # ƒê·∫∑t t√™n ƒë·ªÉ d·ªÖ qu·∫£n l√Ω
    container_name: vocab_redis

    # Mapping c·ªïng Redis.
    # C·ªïng 6379 l√† c·ªïng chu·∫©n c·ªßa Redis.
    ports:
      - "6379:6379"

    # T·ª± ƒë·ªông kh·ªüi ƒë·ªông l·∫°i n·∫øu c√≥ s·ª± c·ªë
    restart: always

# --- PH·∫¶N 3: VOLUMES DECLARATION (KHAI B√ÅO KHO CH·ª®A) ---
# B·∫°n ƒë√£ d√πng 'postgres_data' ·ªü tr√™n, n√™n b·∫°n ph·∫£i ƒëƒÉng k√Ω n√≥ ·ªü ƒë√¢y.
volumes:
  postgres_data:
    # M·∫∑c ƒë·ªãnh Docker s·∫Ω t·∫°o volume n√†y ·ªü s√¢u trong h·ªá th·ªëng file c·ªßa Docker
    # (th∆∞·ªùng l√† /var/lib/docker/volumes/...)



================================================
FILE: apps/extension.crx
================================================
[Binary file]


================================================
FILE: apps/extension.pem
================================================
-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCrbUhiqOJ58LhD
LHaHpcW8G0IRVgG2xN01/1r72xQzhDxR0zgBDwpOuzSr6Z7ciKAv/6Na0ngp/uLr
t7MqC+ZFdodkSA/62OsGT0HT2i4fP/Tcq1rO2r7a6AWE0p8PmnsHnjHBkc8iJ/He
1ERa2ItBC5pforCelahTiQTftFqv3Oi98MjeMZL4neFngqqnfR24Vy+bUibShLjL
vzDwK65NbPz7FKMdl+8+fcfgpvN0Xh8Bbeq/ZGHNkrcUYYEXIg14JYWctWmeBp5+
0ZB/cG2tZ6LL0HuJy3SwEEghTHLVVb5Uxfma4S1CfoArsSICCTmvgxs5haH600AF
y0C67Rg/AgMBAAECggEAFEWaF8Cs94qV36u0YJoj5fi7OV2YWkqxdh86XSotG2J5
15tItidXKrRMqD+6P44Qk1yBrs3Q0/aGUyWoFELP+krn+93hteJM+LQKrsjQR3XC
uQ2ycV/AzhY+ANT/ZlL4VZBJhgB+JCXhHl6vrqaI4SpEGSceB8Le4vIDF4k2aDFf
sLObfrHGdi/NWxsiB7LFSYCdoxmP1mZkx26cdlRP9LU3ot2Za+gc3i9SMrelwsoJ
VhQyubbl8GNq8IZKROOVscaAhbziqy1PRy/4HviG1OW3m7VJNKYGA3F3KTWdnF0y
J5VGco0farTDvanRHhY62tlzFRzrfA0MmJacJOYI8QKBgQDnnGklNniD05KoeZaR
2BMhxpfNtqqvtYX6wJfDHWHmLjYKs44gOsQDs36raNAjNl8xJH51t0pe1HEn0RI/
ltiCvpd5S7yxjAfGbgMu/Xq+bBYvr48CXOrshrIdDzkqz+uRZgJWxg2LYkBAe81r
ZXuOgHmjs5TQrgfEbllyIatblQKBgQC9ennTRxg4TdztH5Ys7rO+5EYM4KaTUvZQ
Lxz+iihgbtmFEm9QKjFgM/u6sP1yBQ4NxLSAQ/fvC5WXUx/cg/3g9cyZ82Cw7up7
KZrwgZulKpLnI35J4BHLTP5rubiuBoLd0+UQTlViU9meJSsrWciiGOUzILrSuKkb
nJ+ymoGPgwKBgHuTOYqQWJbFkO9xCERCjFquEhrBRqq/aH/UuGRzTeO5bj4hdUh+
8kyjPYeJQdw3y2x18z8tj3GvWbyL0Xe6LUT9Geau4Tu94fwegHZW6mGlW+UPf3cc
Sn/ukiPtFmxgSWjni4Hu5BUlU/DT3VNa7ySmKcCNNW5uHFjTI8hAbKRNAoGBAKYc
rJcEOgCKioe77F2B+0T8PUlm3cJEtjo/w4yHtLQuGjamnb3K77SmficCqX7/XX3G
mHPmooMIReH/duxNLxK8it3g10Dmg9zr8bCt/7UCKP3ISRwc+5ye6GGq1XSDstEk
xinQctycJCmX7ku4D8PETZPQOtkoGOFjI0JiX/lfAoGAMLpVvGf/ncOTVazUAKJU
ZIGexPhTKLVt9F/G/EkRnIBF/TEPcNOJXbsYA0GgJ0qw652chWs34CCquIhk1U4V
z3zM/k5PfbZspGpqT5yatnQz/jwLNAhl2SPL4Xezg6Bx8iQbkmuY66+B/xTdmZBv
sTbdiRavz2sw0XuG5X5CoUQ=
-----END PRIVATE KEY-----



================================================
FILE: apps/tree.txt
================================================
[Binary file]


================================================
FILE: apps/backend/README.md
================================================
<p align="center">
  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
</p>

[circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
[circleci-url]: https://circleci.com/gh/nestjs/nest

  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
    <p align="center">
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
<a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
<a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
<a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
<a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
  <a href="https://paypal.me/kamilmysliwiec" target="_blank"><img src="https://img.shields.io/badge/Donate-PayPal-ff3f59.svg" alt="Donate us"/></a>
    <a href="https://opencollective.com/nest#sponsor"  target="_blank"><img src="https://img.shields.io/badge/Support%20us-Open%20Collective-41B883.svg" alt="Support us"></a>
  <a href="https://twitter.com/nestframework" target="_blank"><img src="https://img.shields.io/twitter/follow/nestframework.svg?style=social&label=Follow" alt="Follow us on Twitter"></a>
</p>
  <!--[![Backers on Open Collective](https://opencollective.com/nest/backers/badge.svg)](https://opencollective.com/nest#backer)
  [![Sponsors on Open Collective](https://opencollective.com/nest/sponsors/badge.svg)](https://opencollective.com/nest#sponsor)-->

## Description

[Nest](https://github.com/nestjs/nest) framework TypeScript starter repository.

## Project setup

```bash
$ npm install
```

## Compile and run the project

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## Run tests

```bash
# unit tests
$ npm run test

# e2e tests
$ npm run test:e2e

# test coverage
$ npm run test:cov
```

## Deployment

When you're ready to deploy your NestJS application to production, there are some key steps you can take to ensure it runs as efficiently as possible. Check out the [deployment documentation](https://docs.nestjs.com/deployment) for more information.

If you are looking for a cloud-based platform to deploy your NestJS application, check out [Mau](https://mau.nestjs.com), our official platform for deploying NestJS applications on AWS. Mau makes deployment straightforward and fast, requiring just a few simple steps:

```bash
$ npm install -g @nestjs/mau
$ mau deploy
```

With Mau, you can deploy your application in just a few clicks, allowing you to focus on building features rather than managing infrastructure.

## Resources

Check out a few resources that may come in handy when working with NestJS:

- Visit the [NestJS Documentation](https://docs.nestjs.com) to learn more about the framework.
- For questions and support, please visit our [Discord channel](https://discord.gg/G7Qnnhy).
- To dive deeper and get more hands-on experience, check out our official video [courses](https://courses.nestjs.com/).
- Deploy your application to AWS with the help of [NestJS Mau](https://mau.nestjs.com) in just a few clicks.
- Visualize your application graph and interact with the NestJS application in real-time using [NestJS Devtools](https://devtools.nestjs.com).
- Need help with your project (part-time to full-time)? Check out our official [enterprise support](https://enterprise.nestjs.com).
- To stay in the loop and get updates, follow us on [X](https://x.com/nestframework) and [LinkedIn](https://linkedin.com/company/nestjs).
- Looking for a job, or have a job to offer? Check out our official [Jobs board](https://jobs.nestjs.com).

## Support

Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).

## Stay in touch

- Author - [Kamil My√Ö‚Ä∫liwiec](https://twitter.com/kammysliwiec)
- Website - [https://nestjs.com](https://nestjs.com/)
- Twitter - [@nestframework](https://twitter.com/nestframework)

## License

Nest is [MIT licensed](https://github.com/nestjs/nest/blob/master/LICENSE).



================================================
FILE: apps/backend/eslint.config.mjs
================================================
// @ts-check
import eslint from '@eslint/js';
import eslintPluginPrettierRecommended from 'eslint-plugin-prettier/recommended';
import globals from 'globals';
import tseslint from 'typescript-eslint';

export default tseslint.config(
  {
    ignores: ['eslint.config.mjs'],
  },
  eslint.configs.recommended,
  ...tseslint.configs.recommendedTypeChecked,
  eslintPluginPrettierRecommended,
  {
    languageOptions: {
      globals: {
        ...globals.node,
        ...globals.jest,
      },
      sourceType: 'commonjs',
      parserOptions: {
        projectService: true,
        tsconfigRootDir: import.meta.dirname,
      },
    },
  },
  {
    rules: {
      '@typescript-eslint/no-explicit-any': 'off',
      '@typescript-eslint/no-floating-promises': 'warn',
      '@typescript-eslint/no-unsafe-argument': 'warn',
      "prettier/prettier": ["error", { endOfLine: "auto" }],
    },
  },
);



================================================
FILE: apps/backend/nest-cli.json
================================================
{
  "$schema": "https://json.schemastore.org/nest-cli",
  "collection": "@nestjs/schematics",
  "sourceRoot": "src",
  "compilerOptions": {
    "deleteOutDir": true
  }
}



================================================
FILE: apps/backend/package.json
================================================
{
  "name": "backend",
  "version": "0.0.1",
  "description": "",
  "author": "",
  "private": true,
  "license": "UNLICENSED",
  "scripts": {
    "build": "nest build",
    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
    "start": "nest start",
    "start:dev": "nest start --watch",
    "start:debug": "nest start --debug --watch",
    "start:prod": "node dist/main",
    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:cov": "jest --coverage",
    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
    "test:e2e": "jest --config ./test/jest-e2e.json"
  },
  "dependencies": {
    "@nestjs/common": "^11.0.1",
    "@nestjs/config": "^4.0.2",
    "@nestjs/core": "^11.0.1",
    "@nestjs/jwt": "^11.0.2",
    "@nestjs/mapped-types": "*",
    "@nestjs/passport": "^11.0.5",
    "@nestjs/platform-express": "^11.0.1",
    "@prisma/client": "^5.10.2",
    "@types/passport-local": "^1.0.38",
    "bcrypt": "^6.0.0",
    "class-transformer": "^0.5.1",
    "class-validator": "^0.14.3",
    "csv-parser": "^3.2.0",
    "passport": "^0.7.0",
    "passport-google-oauth20": "^2.0.0",
    "passport-jwt": "^4.0.1",
    "passport-local": "^1.0.0",
    "reflect-metadata": "^0.2.2",
    "rxjs": "^7.8.1"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3.2.0",
    "@eslint/js": "^9.18.0",
    "@nestjs/cli": "^11.0.0",
    "@nestjs/schematics": "^11.0.0",
    "@nestjs/testing": "^11.0.1",
    "@types/bcrypt": "^6.0.0",
    "@types/express": "^5.0.0",
    "@types/jest": "^30.0.0",
    "@types/multer": "^2.0.0",
    "@types/node": "^22.19.2",
    "@types/passport-google-oauth20": "^2.0.17",
    "@types/passport-jwt": "^4.0.1",
    "@types/supertest": "^6.0.2",
    "eslint": "^9.18.0",
    "eslint-config-prettier": "^10.0.1",
    "eslint-plugin-prettier": "^5.2.2",
    "globals": "^16.0.0",
    "jest": "^30.0.0",
    "prettier": "^3.4.2",
    "prisma": "^5.10.2",
    "source-map-support": "^0.5.21",
    "supertest": "^7.0.0",
    "ts-jest": "^29.2.5",
    "ts-loader": "^9.5.2",
    "ts-node": "^10.9.2",
    "tsconfig-paths": "^4.2.0",
    "typescript": "^5.7.3",
    "typescript-eslint": "^8.20.0"
  },
  "jest": {
    "moduleFileExtensions": [
      "js",
      "json",
      "ts"
    ],
    "rootDir": "src",
    "testRegex": ".*\\.spec\\.ts$",
    "transform": {
      "^.+\\.(t|j)s$": "ts-jest"
    },
    "collectCoverageFrom": [
      "**/*.(t|j)s"
    ],
    "coverageDirectory": "../coverage",
    "testEnvironment": "node"
  }
}



================================================
FILE: apps/backend/tree.txt
================================================
backend
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ README.md
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ eslint.config.mjs
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ nest-cli.json
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ package-lock.json
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ package.json
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ prisma
√¢‚Äù‚Äö   √¢‚Äù‚Äù√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ schema.prisma
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ src
√¢‚Äù‚Äö   √¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ app.controller.spec.ts
√¢‚Äù‚Äö   √¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ app.controller.ts
√¢‚Äù‚Äö   √¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ app.module.ts
√¢‚Äù‚Äö   √¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ app.service.ts
√¢‚Äù‚Äö   √¢‚Äù‚Äù√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ main.ts
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ test
√¢‚Äù‚Äö   √¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ app.e2e-spec.ts
√¢‚Äù‚Äö   √¢‚Äù‚Äù√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ jest-e2e.json
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ tree.txt
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ tsconfig.build.json
√¢‚Äù‚Äù√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ tsconfig.json



================================================
FILE: apps/backend/tsconfig.build.json
================================================
{
  "extends": "./tsconfig.json",
  "exclude": ["node_modules", "test", "dist", "**/*spec.ts"]
}



================================================
FILE: apps/backend/tsconfig.json
================================================
{
  "compilerOptions": {
    "module": "nodenext",
    "moduleResolution": "nodenext",
    "resolvePackageJsonExports": true,
    "esModuleInterop": true,
    "isolatedModules": true,
    "declaration": true,
    "removeComments": true,
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "allowSyntheticDefaultImports": true,
    "target": "ES2023",
    "sourceMap": true,
    "outDir": "./dist",
    "incremental": true,
    "skipLibCheck": true,
    "strictNullChecks": true,
    "forceConsistentCasingInFileNames": true,
    "noImplicitAny": false,
    "strictBindCallApply": false,
    "noFallthroughCasesInSwitch": false
  }
}



================================================
FILE: apps/backend/.prettierrc
================================================
{
  "singleQuote": true,
  "trailingComma": "all"
}



================================================
FILE: apps/backend/prisma/schema.prisma
================================================
// c2025-12-09-full-app-english\apps\backend\prisma\schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// 1. B·∫£ng User (Ng∆∞·ªùi d√πng)
model User {
  id       String  @id @default(uuid())
  email    String  @unique
  password String? // üëà Th√™m d·∫•u ? ƒë·ªÉ cho ph√©p Null (User Google kh√¥ng c√≥ pass)
  name     String?
  avatar   String? // üëà Th√™m tr∆∞·ªùng n√†y ƒë·ªÉ l∆∞u ·∫£nh ƒë·∫°i di·ªán t·ª´ Google
  provider String  @default("local") // "local" ho·∫∑c "google"
  googleId String? @unique // ID ri√™ng c·ªßa Google tr·∫£ v·ªÅ

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  vocabItems VocabItem[]

  @@map("users")
}

// 2. B·∫£ng VocabItem (T·ª´ v·ª±ng)
// apps/backend/prisma/schema.prisma

model VocabItem {
  id                  String  @id @default(uuid())
  // üëá TH√äM D√íNG N√ÄY: L∆∞u l·ªãch s·ª≠ ƒëi·ªÉm s·ªë (PostgreSQL h·ªó tr·ª£ m·∫£ng Int[])
  pronunciationScores Int[]   @default([])
  // --- C√ÅC C·ªòT KH·ªöP V·ªöI EXCEL ---
  topic               String? // Topic
  word                String // Word (B·∫Øt bu·ªôc)
  partOfSpeech        String? @map("part_of_speech") // Part of speech
  pronunciation       String? // Pronunciation
  meaning             String? // Meaning
  example             String? // Example
  relatedWords        String? @map("related_words") // Related words
  occurrence          Int?    @default(1)
  isStarred           Boolean @default(false) // üëà New field: M·∫∑c ƒë·ªãnh l√† false, ƒë√°nh d·∫•u th√¨ true

  // --- C√ÅC C·ªòT H·ªÜ TH·ªêNG (B·∫Øt bu·ªôc ph·∫£i gi·ªØ) ---
  userId String @map("user_id")
  user   User   @relation(fields: [userId], references: [id])

  // Map c·ªôt "Time" trong Excel v√†o createdAt
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // X√≥a c√°c tr∆∞·ªùng c≈© kh√¥ng d√πng n·ªØa (imageUrl, audioUrl, tags, masteryLevel...)
  // Ho·∫∑c c·ª© ƒë·ªÉ ƒë√≥ n·∫øu sau n√†y mu·ªën d√πng l·∫°i, nh∆∞ng ·ªü ƒë√¢y m√¨nh x√≥a cho g·ªçn theo √Ω b·∫°n.

  @@index([userId])
  @@map("vocab_items")
}



================================================
FILE: apps/backend/src/app.controller.spec.ts
================================================
import { Test, TestingModule } from '@nestjs/testing';
import { AppController } from './app.controller';
import { AppService } from './app.service';

describe('AppController', () => {
  let appController: AppController;

  beforeEach(async () => {
    const app: TestingModule = await Test.createTestingModule({
      controllers: [AppController],
      providers: [AppService],
    }).compile();

    appController = app.get<AppController>(AppController);
  });

  describe('root', () => {
    it('should return "Hello World!"', () => {
      expect(appController.getHello()).toBe('Hello World!');
    });
  });
});



================================================
FILE: apps/backend/src/app.controller.ts
================================================
import { Controller, Get } from '@nestjs/common';
import { AppService } from './app.service';

@Controller()
export class AppController {
  constructor(private readonly appService: AppService) {}

  @Get()
  getHello(): string {
    return this.appService.getHello();
  }
}



================================================
FILE: apps/backend/src/app.module.ts
================================================
// apps/backend/src/app.module.ts
import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';
import { AppController } from './app.controller';
import { AppService } from './app.service';
import { PrismaModule } from './prisma/prisma.module';
import { AuthModule } from './modules/auth/auth.module';
import { UsersModule } from './modules/users/users.module';
import { VocabularyModule } from './modules/vocabulary/vocabulary.module';

@Module({
  imports: [
    ConfigModule.forRoot({
      isGlobal: true, // üëà Quan tr·ªçng!
    }),
    PrismaModule,
    AuthModule,
    UsersModule,
    VocabularyModule,
  ],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {}



================================================
FILE: apps/backend/src/app.service.ts
================================================
import { Injectable } from '@nestjs/common';

@Injectable()
export class AppService {
  getHello(): string {
    return 'Hello World!';
  }
}



================================================
FILE: apps/backend/src/main.ts
================================================
import { NestFactory } from '@nestjs/core';
import { ValidationPipe } from '@nestjs/common';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);

  // Enable CORS with credentials
  app.enableCors({
    origin: true, // √∞≈∏‚ÄòÀÜ Th√É¬™m c√°¬∫¬£ 2 port
    credentials: true,
    methods: ['GET', 'POST', 'PUT', 'PATCH', 'DELETE', 'OPTIONS'],
    allowedHeaders: ['Content-Type', 'Authorization'],
  });

  // Enable validation
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true,
      transform: true,
    }),
  );

  await app.listen(5000);
  console.log('√∞≈∏≈°‚Ç¨ Backend running on http://localhost:5000');
}
bootstrap();


================================================
FILE: apps/backend/src/modules/auth/auth.controller.ts
================================================
import { Controller, Post, Body, Get, UseGuards, Req, Res } from '@nestjs/common';
import { AuthService } from './auth.service';
import { GoogleAuthGuard } from './guards/google-auth.guard';
import { JwtAuthGuard } from './guards/jwt-auth.guard';
import type { Response } from 'express'; // √∞≈∏‚ÄòÀÜ Th√É¬™m "type"

@Controller('auth')
export class AuthController {
  constructor(private readonly authService: AuthService) {}

  @Post('register')
  async register(
    @Body() body: { email: string; password: string; name?: string },
  ) {
    return this.authService.register(body.email, body.password, body.name);
  }

  @Post('login')
  async login(@Body() body: { email: string; password: string }) {
    return this.authService.login(body.email, body.password);
  }

  @Get('google')
  @UseGuards(GoogleAuthGuard)
  async googleAuth() {
    // Redirects to Google
  }

  @Get('google/callback')
  @UseGuards(GoogleAuthGuard)
  async googleAuthRedirect(@Req() req, @Res() res: Response) {
    const result = await this.authService.googleLogin(req.user);

    const frontendUrl = `http://localhost:3000/auth/callback?token=${result.token}`;
    return res.redirect(frontendUrl);
  }

  @Get('me')
  @UseGuards(JwtAuthGuard)
  async getMe(@Req() req) {
    return this.authService.getUserById(req.user.id);
  }
}


================================================
FILE: apps/backend/src/modules/auth/auth.module.ts
================================================
// apps/backend/src/modules/auth/auth.module.ts
import { Module } from '@nestjs/common';
import { JwtModule } from '@nestjs/jwt';
import { PassportModule } from '@nestjs/passport';
import { ConfigModule, ConfigService } from '@nestjs/config';
import { AuthService } from './auth.service';
import { AuthController } from './auth.controller';
import { PrismaModule } from '../../prisma/prisma.module';
import { LocalStrategy } from './strategies/local.strategy';
import { JwtStrategy } from './strategies/jwt.strategy';
import { GoogleStrategy } from './strategies/google.strategy';

@Module({
  imports: [
    PrismaModule,
    PassportModule,
    ConfigModule,
    JwtModule.registerAsync({
      imports: [ConfigModule],
      useFactory: async (configService: ConfigService) => ({
        secret: configService.get('JWT_SECRET') || 'your-secret-key-change-in-production',
        signOptions: { expiresIn: '7d' },
      }),
      inject: [ConfigService],
    }),
  ],
  controllers: [AuthController],
  providers: [AuthService, LocalStrategy, JwtStrategy, GoogleStrategy],
  exports: [AuthService],
})
export class AuthModule {}


================================================
FILE: apps/backend/src/modules/auth/auth.service.ts
================================================
// apps/backend/src/modules/auth/auth.service.ts

import { Injectable, UnauthorizedException, ConflictException } from '@nestjs/common';
import { JwtService } from '@nestjs/jwt';
import { PrismaService } from '../../prisma/prisma.service';
import * as bcrypt from 'bcrypt';

@Injectable()
export class AuthService {
  constructor(
    private prisma: PrismaService,
    private jwtService: JwtService,
  ) {}

  // ========== REGISTER WITH EMAIL/PASSWORD ==========
  async register(email: string, password: string, name?: string) {
    // Check if user exists
    const existingUser = await this.prisma.user.findUnique({
      where: { email },
    });

    if (existingUser) {
      throw new ConflictException('Email already exists');
    }

    // Hash password
    const hashedPassword = await bcrypt.hash(password, 10);

    // Create user
    const user = await this.prisma.user.create({
      data: {
        email,
        password: hashedPassword,
        name: name || email.split('@')[0], // Default name from email
        provider: 'local',
      },
    });

    // Generate token
    const token = this.generateToken(user.id, user.email);

    return {
      user: {
        id: user.id,
        email: user.email,
        name: user.name,
        avatar: user.avatar,
      },
      token,
    };
  }

  // ========== LOGIN WITH EMAIL/PASSWORD ==========
  async login(email: string, password: string) {
    // Find user
    const user = await this.prisma.user.findUnique({
      where: { email },
    });

    if (!user || !user.password) {
      throw new UnauthorizedException('Invalid credentials');
    }

    // Check password
    const isPasswordValid = await bcrypt.compare(password, user.password);

    if (!isPasswordValid) {
      throw new UnauthorizedException('Invalid credentials');
    }

    // Generate token
    const token = this.generateToken(user.id, user.email);

    return {
      user: {
        id: user.id,
        email: user.email,
        name: user.name,
        avatar: user.avatar,
      },
      token,
    };
  }

  // ========== GOOGLE OAUTH LOGIN ==========
  async googleLogin(googleUser: {
    email: string;
    firstName: string;
    lastName: string;
    picture: string;
    googleId: string;
  }) {
    // Check if user exists
    let user = await this.prisma.user.findUnique({
      where: { email: googleUser.email },
    });

    if (!user) {
      // Create new user from Google
      user = await this.prisma.user.create({
        data: {
          email: googleUser.email,
          name: `${googleUser.firstName} ${googleUser.lastName}`,
          avatar: googleUser.picture,
          provider: 'google',
          googleId: googleUser.googleId,
          password: null, // Google users don't have password
        },
      });
    } else if (user.provider === 'local') {
      // Link Google to existing local account
      user = await this.prisma.user.update({
        where: { id: user.id },
        data: {
          googleId: googleUser.googleId,
          avatar: googleUser.picture, // Update avatar
        },
      });
    }

    // Generate token
    const token = this.generateToken(user.id, user.email);

    return {
      user: {
        id: user.id,
        email: user.email,
        name: user.name,
        avatar: user.avatar,
      },
      token,
    };
  }

  // ========== VALIDATE USER (For Passport) ==========
  async validateUser(email: string, password: string): Promise<any> {
    const user = await this.prisma.user.findUnique({
      where: { email },
    });

    if (user && user.password) {
      const isPasswordValid = await bcrypt.compare(password, user.password);
      if (isPasswordValid) {
        const { password, ...result } = user;
        return result;
      }
    }
    return null;
  }

  // ========== GET USER BY ID ==========
  async getUserById(id: string) {
    const user = await this.prisma.user.findUnique({
      where: { id },
      select: {
        id: true,
        email: true,
        name: true,
        avatar: true,
        provider: true,
        createdAt: true,
      },
    });

    if (!user) {
      throw new UnauthorizedException('User not found');
    }

    return user;
  }

  // ========== HELPER: GENERATE JWT TOKEN ==========
  private generateToken(userId: string, email: string) {
    return this.jwtService.sign({
      sub: userId,
      email,
    });
  }
}


================================================
FILE: apps/backend/src/modules/auth/dto/create-auth.dto.ts
================================================
export class CreateAuthDto {}



================================================
FILE: apps/backend/src/modules/auth/dto/update-auth.dto.ts
================================================
import { PartialType } from '@nestjs/mapped-types';
import { CreateAuthDto } from './create-auth.dto';

export class UpdateAuthDto extends PartialType(CreateAuthDto) {}



================================================
FILE: apps/backend/src/modules/auth/entities/auth.entity.ts
================================================
export class Auth {}



================================================
FILE: apps/backend/src/modules/auth/guards/google-auth.guard.ts
================================================
import { Injectable } from '@nestjs/common';
import { AuthGuard } from '@nestjs/passport';

@Injectable()
export class GoogleAuthGuard extends AuthGuard('google') {}


================================================
FILE: apps/backend/src/modules/auth/guards/jwt-auth.guard.ts
================================================
import { Injectable } from '@nestjs/common';
import { AuthGuard } from '@nestjs/passport';

@Injectable()
export class JwtAuthGuard extends AuthGuard('jwt') {}



================================================
FILE: apps/backend/src/modules/auth/guards/local-auth.guard.ts
================================================
import { Injectable } from '@nestjs/common';
import { AuthGuard } from '@nestjs/passport';

@Injectable()
export class LocalAuthGuard extends AuthGuard('local') {}



================================================
FILE: apps/backend/src/modules/auth/strategies/google.strategy.ts
================================================
import { Injectable } from '@nestjs/common';
import { PassportStrategy } from '@nestjs/passport';
import { Strategy, VerifyCallback, Profile, StrategyOptions } from 'passport-google-oauth20';
import { ConfigService } from '@nestjs/config';

@Injectable()
export class GoogleStrategy extends PassportStrategy(Strategy, 'google') {
  constructor(private configService: ConfigService) {
    super({
      clientID: configService.get<string>('GOOGLE_CLIENT_ID') || '',
      clientSecret: configService.get<string>('GOOGLE_CLIENT_SECRET') || '',
      callbackURL: 'http://localhost:5000/auth/google/callback',
      scope: ['email', 'profile'],
    } as StrategyOptions); // √∞≈∏‚ÄòÀÜ Th√É¬™m "as StrategyOptions"
  }

  async validate(
    accessToken: string,
    refreshToken: string,
    profile: Profile,
    done: VerifyCallback,
  ): Promise<any> {
    const { name, emails, photos, id } = profile;
    
    const user = {
      email: emails?.[0]?.value || '',
      firstName: name?.givenName || '',
      lastName: name?.familyName || '',
      picture: photos?.[0]?.value || '',
      googleId: id,
    };

    done(null, user);
  }
}


================================================
FILE: apps/backend/src/modules/auth/strategies/jwt.strategy.ts
================================================
// apps/backend/src/modules/auth/strategies/jwt.strategy.ts
import { ExtractJwt, Strategy } from 'passport-jwt';
import { PassportStrategy } from '@nestjs/passport';
import { Injectable } from '@nestjs/common';
import { ConfigService } from '@nestjs/config';

@Injectable()
export class JwtStrategy extends PassportStrategy(Strategy) {
  constructor(private configService: ConfigService) {
    super({
      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
      ignoreExpiration: false,
      secretOrKey: configService.get('JWT_SECRET') || 'your-secret-key-change-in-production',
    });
  }

  async validate(payload: any) {
    return { 
      id: payload.sub, 
      email: payload.email 
    };
  }
}


================================================
FILE: apps/backend/src/modules/auth/strategies/local.strategy.ts
================================================
// apps/backend/src/modules/auth/strategies/local.strategy.ts
import { Strategy } from 'passport-local';
import { PassportStrategy } from '@nestjs/passport';
import { Injectable, UnauthorizedException } from '@nestjs/common';
import { AuthService } from '../auth.service';

@Injectable()
export class LocalStrategy extends PassportStrategy(Strategy) {
  constructor(private authService: AuthService) {
    super({
      usernameField: 'email', // M√°¬∫¬∑c √Ñ‚Äò√°¬ª‚Äπnh l√É¬† 'username', m√É¬¨nh √Ñ‚Äò√°¬ª‚Ä¢i th√É¬†nh 'email' cho √Ñ‚Äò√É¬∫ng project
    });
  }

  // H√É¬†m n√É¬†y s√°¬∫¬Ω t√°¬ª¬± √Ñ‚Äò√°¬ª‚Ñ¢ng ch√°¬∫¬°y khi user login
  async validate(email: string, pass: string): Promise<any> {
    const user = await this.authService.validateUser(email, pass);
    if (!user) {
      throw new UnauthorizedException('Sai email ho√°¬∫¬∑c m√°¬∫¬≠t kh√°¬∫¬©u');
    }
    return user;
  }
}



================================================
FILE: apps/backend/src/modules/users/users.controller.ts
================================================
import { Controller, Post, Body } from '@nestjs/common';
import { UsersService } from './users.service';
import { CreateUserDto } from './dto/create-user.dto';

@Controller('users')
export class UsersController {
  constructor(private readonly usersService: UsersService) {}

  @Post()
  create(@Body() createUserDto: CreateUserDto) {
    return this.usersService.create(createUserDto);
  }

  // T·∫°m th·ªùi b·ªè c√°c route findAll, findOne, update, remove 
  // v√¨ Service ch∆∞a implement logic ƒë√≥.
}


================================================
FILE: apps/backend/src/modules/users/users.module.ts
================================================
import { Module } from '@nestjs/common';
import { UsersService } from './users.service';
import { UsersController } from './users.controller';

@Module({
  controllers: [UsersController],
  providers: [UsersService],
  exports: [UsersService],
})
export class UsersModule {}



================================================
FILE: apps/backend/src/modules/users/users.service.ts
================================================
import { Injectable } from '@nestjs/common';
import { CreateUserDto } from './dto/create-user.dto';
import { PrismaService } from '../../prisma/prisma.service'; // Import global service
import * as bcrypt from 'bcrypt';

@Injectable()
export class UsersService {
  constructor(private prisma: PrismaService) {}

  async create(createUserDto: CreateUserDto) {
    const { email, password, name } = createUserDto;
    // Hash password logic
    const hashedPassword = password ? await bcrypt.hash(password, 10) : null;

    return this.prisma.user.create({
      data: {
        email,
        password: hashedPassword,
        name,
      },
    });
  }

  // Find user for Auth logic
  async findOneByEmail(email: string) {
    return this.prisma.user.findUnique({
      where: { email },
    });
  }
}



================================================
FILE: apps/backend/src/modules/users/dto/create-user.dto.ts
================================================
export class CreateUserDto {
  email: string;
  password?: string; // Optional v√É¬¨ sau n√É¬†y c√É¬≥ th√°¬ª∆í login b√°¬∫¬±ng Google
  name?: string;
}



================================================
FILE: apps/backend/src/modules/users/dto/update-user.dto.ts
================================================
import { PartialType } from '@nestjs/mapped-types';
import { CreateUserDto } from './create-user.dto';

export class UpdateUserDto extends PartialType(CreateUserDto) {}



================================================
FILE: apps/backend/src/modules/users/entities/user.entity.ts
================================================
export class User {}



================================================
FILE: apps/backend/src/modules/vocabulary/vocabulary.controller.ts
================================================
import {
  Controller,
  Get,
  Post,
  Body,
  Patch,
  Param,
  Delete,
  UseGuards,
  Request,
  UseInterceptors,
  UploadedFile,
  Query,
} from '@nestjs/common';
import { FileInterceptor } from '@nestjs/platform-express';
import { VocabularyService } from './vocabulary.service';
import { CreateVocabularyDto } from './dto/create-vocabulary.dto';
import { UpdateVocabularyDto } from './dto/update-vocabulary.dto';
import { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';

@Controller('vocabulary')
@UseGuards(JwtAuthGuard)
export class VocabularyController {
  constructor(private readonly vocabularyService: VocabularyService) {}

  // √∞≈∏‚Äò‚Ä° TH√É≈†M ROUTE N√É‚Ç¨Y: L√Ü¬∞u √Ñ‚Äòi√°¬ª∆ím ph√É¬°t √É¬¢m
  @Patch(':id/score')
  async addScore(
    @Request() req,
    @Param('id') id: string,
    @Body('score') score: number,
  ) {
    return this.vocabularyService.addScore(id, req.user.id, score);
  }
  @Post()
  create(@Request() req, @Body() createDto: CreateVocabularyDto) {
    // √∞≈∏‚Äò‚Ä° UPDATE: S√°¬ª¬≠ d√°¬ª¬•ng upsertVocab √Ñ‚Äò√°¬ª∆í handle logic create ho√°¬∫¬∑c update n√°¬∫¬øu √Ñ‚Äò√É¬£ t√°¬ª‚Äún t√°¬∫¬°i
    return this.vocabularyService.upsertVocab(req.user.id, createDto);
  }

  @Post('import/csv')
  @UseInterceptors(FileInterceptor('file'))
  async importCsv(@Request() req, @UploadedFile() file: Express.Multer.File) {
    return this.vocabularyService.importFromCsv(req.user.id, file);
  }

  @Get()
  findAll(
    @Request() req,
    @Query('page') page: string,
    @Query('limit') limit: string,
    @Query('search') search: string, // Quick search (t√É¬¨m chung)
    // Filter Params
    @Query('word') word: string,
    @Query('topic') topic: string,
    @Query('partOfSpeech') partOfSpeech: string,
    @Query('meaning') meaning: string,
    @Query('isStarred') isStarred: string, // Filter t√°¬ª¬´ y√É¬™u th√É¬≠ch
    // Sort Params
    @Query('sortBy') sortBy: string,
    @Query('sortOrder') sortOrder: string,
  ) {
    const pageNumber = page ? parseInt(page) : 1;
    const limitNumber = limit ? parseInt(limit) : 20;

    // Gom c√É¬°c filter criteria v√É¬†o m√°¬ª‚Ñ¢t object
    const filters = {
      word,
      topic,
      partOfSpeech,
      meaning,
      // Convert string 'true' th√É¬†nh boolean true, ng√Ü¬∞√°¬ª¬£c l√°¬∫¬°i l√É¬† false/undefined
      isStarred: isStarred === 'true',
    };

    // Config sort option
    const sort = {
      field: sortBy || 'createdAt',
      order: (sortOrder === 'asc' ? 'asc' : 'desc') as 'asc' | 'desc',
    };

    // Call service v√°¬ª‚Ä∫i full arguments
    return this.vocabularyService.findAll(
      req.user.id,
      pageNumber,
      limitNumber,
      filters,
      sort,
      search,
    );
  }

  @Get(':id')
  findOne(@Request() req, @Param('id') id: string) {
    return this.vocabularyService.findOne(id, req.user.id);
  }

  @Patch(':id')
  update(
    @Request() req,
    @Param('id') id: string,
    @Body() updateDto: UpdateVocabularyDto,
  ) {
    return this.vocabularyService.update(id, req.user.id, updateDto);
  }

  @Delete(':id')
  remove(@Request() req, @Param('id') id: string) {
    return this.vocabularyService.remove(id, req.user.id);
  }
}



================================================
FILE: apps/backend/src/modules/vocabulary/vocabulary.module.ts
================================================
// apps/backend/src/modules/vocabulary/vocabulary.module.ts
import { Module } from '@nestjs/common';
import { VocabularyService } from './vocabulary.service';
import { VocabularyController } from './vocabulary.controller';
import { PrismaModule } from '../../prisma/prisma.module';

@Module({
  imports: [PrismaModule],
  controllers: [VocabularyController],
  providers: [VocabularyService],
})
export class VocabularyModule {}



================================================
FILE: apps/backend/src/modules/vocabulary/vocabulary.service.ts
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x81 in position 1436: character maps to <undefined>


================================================
FILE: apps/backend/src/modules/vocabulary/dto/create-vocabulary.dto.ts
================================================
import {
  IsBoolean,
  IsString,
  IsOptional,
  IsInt,
  Min, // Minimum value
} from 'class-validator';

export class CreateVocabularyDto {
  // Field n√†y b·∫Øt bu·ªôc (Required), ph·∫£i l√† String
  @IsString()
  word: string;

  // M·∫•y c√°i d∆∞·ªõi n√†y l√† Optional (c√≥ c≈©ng ƒë∆∞·ª£c, kh√¥ng c√≥ c≈©ng kh√¥ng sao)
  @IsOptional()
  @IsString()
  topic?: string;

  @IsOptional()
  @IsString()
  partOfSpeech?: string; // Lo·∫°i t·ª´ (noun, verb...)

  @IsOptional()
  @IsString()
  pronunciation?: string;

  @IsOptional()
  @IsString()
  meaning?: string;

  @IsOptional()
  @IsString()
  example?: string;

  @IsOptional()
  @IsString()
  relatedWords?: string;

  @IsOptional()
  @IsInt() // Ph·∫£i l√† s·ªë nguy√™n (Integer)
  @Min(0) // Gi√° tr·ªã nh·ªè nh·∫•t l√† 0
  occurrence?: number;

  @IsOptional()
  @IsBoolean()
  isStarred?: boolean; // üëà Add this property
}



================================================
FILE: apps/backend/src/modules/vocabulary/dto/update-vocabulary.dto.ts
================================================
// apps\backend\src\modules\vocabulary\dto\update-vocabulary.dto.ts
import { PartialType } from '@nestjs/mapped-types';
import { CreateVocabularyDto } from './create-vocabulary.dto';

export class UpdateVocabularyDto extends PartialType(CreateVocabularyDto) {}


================================================
FILE: apps/backend/src/modules/vocabulary/entities/vocabulary.entity.ts
================================================
export class Vocabulary {}



================================================
FILE: apps/backend/src/prisma/prisma.module.ts
================================================
import { Global, Module } from '@nestjs/common';
import { PrismaService } from './prisma.service';

@Global() // Key concept: Make it global!
@Module({
  providers: [PrismaService],
  exports: [PrismaService], // Export to use in other modules
})
export class PrismaModule {}



================================================
FILE: apps/backend/src/prisma/prisma.service.ts
================================================
import { Injectable, OnModuleInit, OnModuleDestroy } from '@nestjs/common';
import { PrismaClient } from '@prisma/client';

@Injectable()
export class PrismaService
  extends PrismaClient
  implements OnModuleInit, OnModuleDestroy
{
  async onModuleInit() {
    await this.$connect();
    console.log('√¢≈ì‚Ä¶ DB Connected via Prisma');
  }

  async onModuleDestroy() {
    await this.$disconnect();
  }
}



================================================
FILE: apps/backend/test/app.e2e-spec.ts
================================================
import { Test, TestingModule } from '@nestjs/testing';
import { INestApplication } from '@nestjs/common';
import request from 'supertest';
import { App } from 'supertest/types';
import { AppModule } from './../src/app.module';

describe('AppController (e2e)', () => {
  let app: INestApplication<App>;

  beforeEach(async () => {
    const moduleFixture: TestingModule = await Test.createTestingModule({
      imports: [AppModule],
    }).compile();

    app = moduleFixture.createNestApplication();
    await app.init();
  });

  it('/ (GET)', () => {
    return request(app.getHttpServer())
      .get('/')
      .expect(200)
      .expect('Hello World!');
  });
});



================================================
FILE: apps/backend/test/jest-e2e.json
================================================
{
  "moduleFileExtensions": ["js", "json", "ts"],
  "rootDir": ".",
  "testEnvironment": "node",
  "testRegex": ".e2e-spec.ts$",
  "transform": {
    "^.+\\.(t|j)s$": "ts-jest"
  }
}



================================================
FILE: apps/extension/background.js
================================================
// Setup Alarm khi Extension √Ñ‚Äò√Ü¬∞√°¬ª¬£c Installed
chrome.runtime.onInstalled.addListener(() => {
  console.log("Extension Installed. Setting up alarms...");
  // T√°¬∫¬°o alarm t√É¬™n 'vocab_review' ch√°¬∫¬°y m√°¬ª‚Äîi 15 ph√É¬∫t
  chrome.alarms.create("vocab_review", {
    periodInMinutes: 5,
  });
});

// L√°¬∫¬Øng nghe Alarm trigger
chrome.alarms.onAlarm.addListener((alarm) => {
  if (alarm.name === "vocab_review") {
    // T√É¬¨m tab √Ñ‚Äòang active √Ñ‚Äò√°¬ª∆í g√°¬ª¬≠i message hi√°¬ª∆ín th√°¬ª‚Äπ Flashcard
    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {
      if (tabs[0]) {
        chrome.tabs.sendMessage(tabs[0].id, {
          action: "SHOW_FLASHCARD",
        });
      }
    });
  }
});



================================================
FILE: apps/extension/content.js
================================================
[Binary file]


================================================
FILE: apps/extension/manifest.json
================================================
{
  "manifest_version": 3,
  "name": "Edge TTS Reader & Vocabulary Coach",
  "version": "1.2",
  "description": "ƒê·ªçc vƒÉn b·∫£n, Check ph√°t √¢m Azure, D·ªãch ng·ªØ c·∫£nh & √în t·∫≠p t·ª´ v·ª±ng",
  "permissions": ["storage", "microphone", "alarms"],
  "background": {
    "service_worker": "background.js"
  },
  "action": {
    "default_popup": "popup.html"
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"],
      "css": ["popup.css"]
    }
  ],
  "host_permissions": [
    "https://translate.google.com/*",
    "https://translate.googleapis.com/*",
    "https://commons.wikimedia.org/*",
    "https://api.duckduckgo.com/*",
    "https://www.googleapis.com/*",
    "https://api.unsplash.com/*",
    "https://*.cognitiveservices.azure.com/*"
  ]
}


================================================
FILE: apps/extension/popup.css
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8d in position 5187: character maps to <undefined>


================================================
FILE: apps/extension/popup.html
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8f in position 4906: character maps to <undefined>


================================================
FILE: apps/extension/popup.js
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x90 in position 1108: character maps to <undefined>


================================================
FILE: apps/extension/content-scripts/main.js
================================================
// ==========================================
// MODULE: UI MANAGER
// ==========================================
const UI = (() => {
  let iframe = null;

  function create() {
    if (iframe) return;

    iframe = document.createElement("iframe");
    iframe.id = "vocab-extension-overlay";

    // Style ƒë√® full m√†n h√¨nh
    Object.assign(iframe.style, {
      position: "fixed",
      top: "0",
      left: "0",
      width: "100%",
      height: "100%",
      border: "none",
      zIndex: "2147483647",
      backgroundColor: "transparent", // ƒê·ªÉ React t·ª± lo ph·∫ßn n·ªÅn ƒëen m·ªù
    });

    // G·ªçi v·ªÅ Frontend (Localhost)
    // iframeMode=true: ƒë·ªÉ Frontend bi·∫øt ƒë∆∞·ªùng ·∫©n Header/Sidebar n·∫øu c·∫ßn
    iframe.src =
      "http://localhost:3000/vocabulary?openSearch=true&iframeMode=true";
    iframe.allow = "microphone *; camera *; clipboard-write"; // C·∫•p quy·ªÅn Mic

    document.body.appendChild(iframe);

    // Focus v√†o iframe
    iframe.onload = () => iframe.contentWindow.focus();
  }

  function remove() {
    if (iframe) {
      iframe.remove();
      iframe = null;
    }
  }

  function toggle() {
    iframe ? remove() : create();
  }

  return { create, remove, toggle };
})();

// ==========================================
// MODULE: SHORTCUT LISTENER
// ==========================================
window.addEventListener("keydown", (e) => {
  // B·∫Øt s·ª± ki·ªán Shift + Q
  if (e.shiftKey && e.code === "KeyQ") {
    e.preventDefault();
    UI.toggle();
  }
});

// ==========================================
// MODULE: MESSAGE LISTENER (From Iframe)
// ==========================================
// L·∫Øng nghe l·ªánh ƒë√≥ng t·ª´ b√™n trong Iframe (Frontend g·ª≠i ra)
window.addEventListener("message", (event) => {
  // Check origin ƒë·ªÉ b·∫£o m·∫≠t
  if (event.origin !== "http://localhost:3000") return;

  if (event.data === "CLOSE_EXTENSION_IFRAME") {
    UI.remove();
  }
});

console.log("‚úÖ Vocab Extension Loaded: Press Shift+Q to open!");



================================================
FILE: apps/extension/content-scripts/messager.js
================================================
[Empty file]


================================================
FILE: apps/extension/content-scripts/shortcuts.js
================================================
// shortcuts.js
import { toggleOverlay } from "./ui.js";

export const initShortcuts = () => {
  window.addEventListener("keydown", (e) => {
    // Logic: Shift + Q
    if (e.shiftKey && (e.key === "Q" || e.key === "q")) {
      e.preventDefault();
      console.log("√∞≈∏≈°‚Ç¨ Shortcut detected: Shift + Q");
      toggleOverlay();
    }
  });
};



================================================
FILE: apps/extension/content-scripts/ui.js
================================================
// ui.js
let iframeElement = null;

export const createOverlay = () => {
  if (iframeElement) return; // ƒê√£ t·ªìn t·∫°i th√¨ th√¥i

  // 1. T·∫°o Iframe
  iframeElement = document.createElement("iframe");

  // 2. Style cho Iframe (Full m√†n h√¨nh, ƒë√® l√™n t·∫•t c·∫£)
  Object.assign(iframeElement.style, {
    position: "fixed",
    top: "0",
    left: "0",
    width: "100vw",
    height: "100vh",
    border: "none",
    zIndex: "2147483647", // Max z-index
    backgroundColor: "rgba(0,0,0,0.5)", // M√†u n·ªÅn t·ªëi m·ªù
    display: "block",
  });

  // 3. Load trang Vocabulary c·ªßa Frontend v√†o
  // Th√™m param ?openSearch=true ƒë·ªÉ React bi·∫øt ƒë∆∞·ªùng m·ªü Popup ngay l·∫≠p t·ª©c
  iframeElement.src =
    "http://localhost:3000/vocabulary?openSearch=true&iframeMode=true";
  iframeElement.allow = "microphone; camera"; // Quan tr·ªçng: Cho ph√©p d√πng Mic trong Iframe

  document.body.appendChild(iframeElement);

  // 4. Focus v√†o iframe ƒë·ªÉ g√µ ph√≠m ƒë∆∞·ª£c ngay
  iframeElement.onload = () => {
    iframeElement.contentWindow.focus();
  };
};

export const removeOverlay = () => {
  if (iframeElement) {
    iframeElement.remove();
    iframeElement = null;
  }
};

export const toggleOverlay = () => {
  if (iframeElement) {
    removeOverlay();
  } else {
    createOverlay();
  }
};



================================================
FILE: apps/frontend/README.md
================================================
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.



================================================
FILE: apps/frontend/eslint.config.mjs
================================================
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;



================================================
FILE: apps/frontend/next.config.ts
================================================
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
  reactCompiler: true,
  async rewrites() {
    return [
      {
        source: '/vocabulary/search',
        destination: '/vocabulary?openSearch=true',
      },
    ];
  },
};

export default nextConfig;


================================================
FILE: apps/frontend/package.json
================================================
{
  "name": "frontend",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "axios": "^1.13.2",
    "next": "16.0.8",
    "react": "19.2.1",
    "react-dom": "19.2.1"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4.1.17",
    "@tailwindcss/vite": "^4.0.0",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "autoprefixer": "^10.4.22",
    "babel-plugin-react-compiler": "1.0.0",
    "eslint": "^9",
    "eslint-config-next": "16.0.8",
    "postcss": "^8.5.6",
    "tailwindcss": "^4.0.0",
    "typescript": "^5"
  }
}



================================================
FILE: apps/frontend/postcss.config.js
================================================
module.exports = {
  plugins: {
    '@tailwindcss/postcss': {},
  },
}


================================================
FILE: apps/frontend/postcss.config.mjs
================================================
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    "@tailwindcss/postcss": {}, // üëà ƒê·ªïi d√≤ng n√†y
    autoprefixer: {},
  },
};

export default config;



================================================
FILE: apps/frontend/tailwind.config.ts
================================================
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}


================================================
FILE: apps/frontend/tsconfig.json
================================================
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}



================================================
FILE: apps/frontend/app/globals.css
================================================
@import "tailwindcss";



================================================
FILE: apps/frontend/app/layout.tsx
================================================
import type { Metadata } from "next";
import './globals.css'
import { AuthProvider } from "../contexts/AuthContext";

export const metadata: Metadata = {
  title: "Vocabulary App",
  description: "Learn English vocabulary",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>
        <AuthProvider>
          {children}
        </AuthProvider>
      </body>
    </html>
  );
}


================================================
FILE: apps/frontend/app/page.module.css
================================================
.page {
  --background: #fafafa;
  --foreground: #fff;

  --text-primary: #000;
  --text-secondary: #666;

  --button-primary-hover: #383838;
  --button-secondary-hover: #f2f2f2;
  --button-secondary-border: #ebebeb;

  display: flex;
  min-height: 100vh;
  align-items: center;
  justify-content: center;
  font-family: var(--font-geist-sans);
  background-color: var(--background);
}

.main {
  display: flex;
  min-height: 100vh;
  width: 100%;
  max-width: 800px;
  flex-direction: column;
  align-items: flex-start;
  justify-content: space-between;
  background-color: var(--foreground);
  padding: 120px 60px;
}

.intro {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  text-align: left;
  gap: 24px;
}

.intro h1 {
  max-width: 320px;
  font-size: 40px;
  font-weight: 600;
  line-height: 48px;
  letter-spacing: -2.4px;
  text-wrap: balance;
  color: var(--text-primary);
}

.intro p {
  max-width: 440px;
  font-size: 18px;
  line-height: 32px;
  text-wrap: balance;
  color: var(--text-secondary);
}

.intro a {
  font-weight: 500;
  color: var(--text-primary);
}

.ctas {
  display: flex;
  flex-direction: row;
  width: 100%;
  max-width: 440px;
  gap: 16px;
  font-size: 14px;
}

.ctas a {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 40px;
  padding: 0 16px;
  border-radius: 128px;
  border: 1px solid transparent;
  transition: 0.2s;
  cursor: pointer;
  width: fit-content;
  font-weight: 500;
}

a.primary {
  background: var(--text-primary);
  color: var(--background);
  gap: 8px;
}

a.secondary {
  border-color: var(--button-secondary-border);
}

/* Enable hover only on non-touch devices */
@media (hover: hover) and (pointer: fine) {
  a.primary:hover {
    background: var(--button-primary-hover);
    border-color: transparent;
  }

  a.secondary:hover {
    background: var(--button-secondary-hover);
    border-color: transparent;
  }
}

@media (max-width: 600px) {
  .main {
    padding: 48px 24px;
  }

  .intro {
    gap: 16px;
  }

  .intro h1 {
    font-size: 32px;
    line-height: 40px;
    letter-spacing: -1.92px;
  }
}

@media (prefers-color-scheme: dark) {
  .logo {
    filter: invert();
  }

  .page {
    --background: #000;
    --foreground: #000;

    --text-primary: #ededed;
    --text-secondary: #999;

    --button-primary-hover: #ccc;
    --button-secondary-hover: #1a1a1a;
    --button-secondary-border: #1a1a1a;
  }
}



================================================
FILE: apps/frontend/app/page.tsx
================================================
import Image from "next/image";
import styles from "./page.module.css";

export default function Home() {
  return (
    <div className={styles.page}>
      <main className={styles.main}>
        <Image
          className={styles.logo}
          src="/next.svg"
          alt="Next.js logo"
          width={100}
          height={20}
          priority
        />
        <div className={styles.intro}>
          <h1>To get started, edit the page.tsx file.</h1>
          <p>
            Looking for a starting point or more instructions? Head over to{" "}
            <a
              href="https://vercel.com/templates?framework=next.js&utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
              target="_blank"
              rel="noopener noreferrer"
            >
              Templates
            </a>{" "}
            or the{" "}
            <a
              href="https://nextjs.org/learn?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
              target="_blank"
              rel="noopener noreferrer"
            >
              Learning
            </a>{" "}
            center.
          </p>
        </div>
        <div className={styles.ctas}>
          <a
            className={styles.primary}
            href="https://vercel.com/new?utm_source=create-next-app&utm_medium=appdir-template&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            <Image
              className={styles.logo}
              src="/vercel.svg"
              alt="Vercel logomark"
              width={16}
              height={16}
            />
            Deploy Now
          </a>
          <a
            className={styles.secondary}
            href="https://nextjs.org/docs?utm_source=create-next-app&utm_medium=appdir-template&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            Documentation
          </a>
        </div>
      </main>
    </div>
  );
}



================================================
FILE: apps/frontend/app/admin/users/page.tsx
================================================
[Empty file]


================================================
FILE: apps/frontend/app/app/auth/callback/page.tsx
================================================
'use client';

import { useEffect } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';

export default function GoogleCallbackPage() {
  const router = useRouter();
  const searchParams = useSearchParams();

  useEffect(() => {
    const token = searchParams.get('token');

    if (token) {
      // Save token
      localStorage.setItem('token', token);
      
      // Redirect to vocabulary page
      router.push('/vocabulary');
    } else {
      // If no token, redirect to login
      router.push('/login');
    }
  }, [searchParams, router]);

  return (
    <div className="min-h-screen flex items-center justify-center">
      <div className="text-center">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
        <p>Processing login...</p>
      </div>
    </div>
  );
}


================================================
FILE: apps/frontend/app/login/page.tsx
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x90 in position 1222: character maps to <undefined>


================================================
FILE: apps/frontend/app/register/page.tsx
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x9d in position 1134: character maps to <undefined>


================================================
FILE: apps/frontend/app/vocabulary/page.tsx
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x90 in position 5752: character maps to <undefined>


================================================
FILE: apps/frontend/app/vocabulary/tree.txt
================================================
vocabulary
√¢‚Äù≈ì√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ page.tsx
√¢‚Äù‚Äù√¢‚Äù‚Ç¨√¢‚Äù‚Ç¨ tree.txt



================================================
FILE: apps/frontend/components/Icons.tsx
================================================
import React from "react";

export const StarIcon = ({ filled, className }: { filled: boolean; className?: string }) => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill={filled ? "currentColor" : "none"} stroke="currentColor" strokeWidth={filled ? "0" : "2"} strokeLinecap="round" strokeLinejoin="round" className={className} width="24" height="24">
    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
  </svg>
);

export const SpeakerIcon = ({ className }: { className?: string }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
    <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
  </svg>
);

export const MicrophoneIcon = ({ className }: { className?: string }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
    <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
    <line x1="12" y1="19" x2="12" y2="23"></line>
    <line x1="8" y1="23" x2="16" y2="23"></line>
  </svg>
);


================================================
FILE: apps/frontend/components/vocabulary/AssessmentModal.tsx
================================================
import React from "react";
import { MicrophoneIcon, SpeakerIcon } from "@/components/Icons";

// Define Interfaces n√°¬ª‚Ñ¢i b√°¬ª‚Ñ¢ ho√°¬∫¬∑c import t√°¬ª¬´ types chung
interface Props {
  isOpen: boolean;
  onClose: () => void;
  vocabWord: string;
  pronunciation?: string | null;
  meaning?: string | null;
  
  // Recording State
  isRecording: boolean;
  onStartRecording: () => void;
  onStopRecording: () => void;
  userAudioUrl: string | null;
  
  // Processing State
  isProcessing: boolean;
  error: string;
  
  // Result
  result: any; // C√É¬≥ th√°¬ª∆í define strict type AssessmentResult n√°¬∫¬øu mu√°¬ª‚Äòn
}

export default function AssessmentModal({
  isOpen, onClose, vocabWord, pronunciation, meaning,
  isRecording, onStartRecording, onStopRecording, userAudioUrl,
  isProcessing, error, result
}: Props) {
  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 bg-black/80 z-[70] flex items-center justify-center p-4 backdrop-blur-sm" onClick={onClose}>
      <div 
        className="bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden flex flex-col items-center p-8 relative animate-in fade-in zoom-in duration-200"
        onClick={(e) => e.stopPropagation()}
      >
        <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600">√¢≈ì‚Ä¢</button>
        
        <h3 className="text-3xl font-bold text-gray-800 mb-1">{vocabWord}</h3>
        
        <div className="flex flex-col items-center gap-1 mb-6">
          {pronunciation && <span className="font-mono text-gray-500 text-lg">/{pronunciation}/</span>}
          {meaning && <span className="text-gray-600 text-center font-medium px-4 line-clamp-2">{meaning}</span>}
        </div>

        {/* Score Circle */}
        {result ? (
          <div className="relative w-32 h-32 mb-6 flex items-center justify-center rounded-full border-8 transition-all duration-500 ease-out"
            style={{ borderColor: result.AccuracyScore >= 80 ? "#4caf50" : result.AccuracyScore >= 60 ? "#ffeb3b" : "#ff5252" }}>
            <span className="text-4xl font-bold"
              style={{ color: result.AccuracyScore >= 80 ? "#4caf50" : result.AccuracyScore >= 60 ? "#fbc02d" : "#ff5252" }}>
              {Math.round(result.AccuracyScore)}
            </span>
          </div>
        ) : (
          <div className="w-32 h-32 mb-6 rounded-full border-4 border-gray-100 flex items-center justify-center bg-gray-50">
            <span className="text-4xl text-gray-300">?</span>
          </div>
        )}

        {/* Action Buttons */}
        <div className="mb-6 flex gap-6 items-center">
          <button onClick={() => { /* Handle Speak in parent if needed, or pass prop */ }} className="w-12 h-12 rounded-full bg-gray-100 hover:bg-gray-200 text-indigo-600 flex items-center justify-center transition-transform hover:scale-105 shadow-sm">
             <SpeakerIcon className="w-6 h-6" />
          </button>
          
          <button
            onClick={isRecording ? onStopRecording : onStartRecording}
            className={`w-16 h-16 rounded-full flex items-center justify-center shadow-lg transition-all transform hover:scale-105 ${
              isRecording ? "bg-red-500 animate-pulse ring-4 ring-red-200" : "bg-indigo-600 hover:bg-indigo-700 ring-4 ring-indigo-100"
            }`}
          >
            {isRecording ? <div className="w-6 h-6 bg-white rounded-sm" /> : <MicrophoneIcon className="w-8 h-8 text-white" />}
          </button>

          <button
            disabled={!userAudioUrl}
            onClick={() => { const audio = new Audio(userAudioUrl!); audio.play(); }}
            className={`w-12 h-12 rounded-full flex items-center justify-center transition-transform hover:scale-105 shadow-sm ${
              userAudioUrl ? "bg-green-100 hover:bg-green-200 text-green-700 cursor-pointer" : "bg-gray-100 text-gray-300 cursor-not-allowed"
            }`}
          >
             <span className="text-xl">√¢‚Äì¬∂</span>
          </button>
        </div>

        {isProcessing && <p className="text-indigo-500 font-medium animate-pulse">Analyzing...</p>}
        {error && <p className="text-red-500 text-sm text-center bg-red-50 p-2 rounded">{error}</p>}

        {/* Detailed Result */}
        {result && (
          <div className="w-full bg-gray-50 rounded-xl p-4 mt-2 border border-gray-100">
            <div className="flex flex-wrap justify-center gap-x-4 gap-y-2">
              {result.Words.map((word: any, idx: number) => (
                <div key={idx} className="flex flex-col items-center">
                  <span className={`text-lg font-bold ${word.AccuracyScore >= 80 ? "text-green-700" : word.AccuracyScore >= 60 ? "text-yellow-600" : "text-red-600"}`}>
                    {word.Word}
                  </span>
                  <div className="flex gap-0.5 mt-1">
                    {word.Phonemes?.map((p: any, pIdx: number) => (
                      <span key={pIdx}
                        className={`text-xs px-1 rounded min-w-[20px] text-center ${
                          p.AccuracyScore >= 80 ? "bg-green-100 text-green-800" : p.AccuracyScore >= 60 ? "bg-yellow-100 text-yellow-800" : "bg-red-100 text-red-800"
                        }`}
                        title={`/${p.Phoneme}/: ${p.AccuracyScore}`}
                      >
                        {p.Phoneme}
                      </span>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}
      </div>
    </div>
  );
}


================================================
FILE: apps/frontend/components/vocabulary/QuickSearchModal.tsx
================================================
// apps/frontend/components/vocabulary/QuickSearchModal.tsx
import React, { useEffect, useRef } from "react";

// ƒê·ªãnh nghƒ©a l·∫°i interface VocabItem ·ªü ƒë√¢y (ho·∫∑c import n·∫øu b·∫°n c√≥ file types chung)
interface VocabItem {
  id: string;
  word: string;
  meaning?: string | null;
  partOfSpeech?: string | null;
  topic?: string | null;
  isStarred?: boolean;
  occurrence?: number;
}

interface Props {
  isOpen: boolean;
  onClose: () => void;
  searchText: string;
  onSearchChange: (text: string) => void;
  results: VocabItem[];
  isSearching: boolean;
  isIframeMode: boolean; // üëá Quan tr·ªçng ƒë·ªÉ ch·ªânh ƒë·ªô m·ªù
  
  // C√°c Actions
  onSelect: (item: VocabItem) => void;
  onCreate: (text: string) => void;
  onSpeak: (text: string, e: React.MouseEvent) => void;
  onOpenAssessment: (item: VocabItem, e: React.MouseEvent) => void;
}

export default function QuickSearchModal({
  isOpen,
  onClose,
  searchText,
  onSearchChange,
  results,
  isSearching,
  isIframeMode,
  onSelect,
  onCreate,
  onSpeak,
  onOpenAssessment
}: Props) {
  const inputRef = useRef<HTMLInputElement>(null);

  useEffect(() => {
    if (isOpen) {
      setTimeout(() => inputRef.current?.focus(), 100);
    }
  }, [isOpen]);

  if (!isOpen) return null;

  // üëá LOGIC FIX BLUR: 
  // N·∫øu l√† Iframe (Extension): N·ªÅn trong su·ªët ho·∫∑c r·∫•t m·ªù ƒë·ªÉ nh√¨n th·∫•y web d∆∞·ªõi
  // N·∫øu l√† Web th∆∞·ªùng: N·ªÅn ƒëen m·ªù 60%
  const overlayClass = isIframeMode
    ? "fixed inset-0 bg-black/5 z-[100] flex items-start justify-center pt-20"
    : "fixed inset-0 bg-black/60 z-[100] flex items-start justify-center pt-32 backdrop-blur-sm";

  const hasExactMatch = results.some(
    (item) => item.word.toLowerCase() === searchText.trim().toLowerCase()
  );

  return (
    <div className={overlayClass} onClick={onClose}>
      <div
        className="bg-white w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden flex flex-col mx-4 border border-gray-100"
        onClick={(e) => e.stopPropagation()}
      >
        <div className="p-4 border-b border-gray-100 flex items-center gap-3">
          <span className="text-xl">üîç</span>
          <input
            ref={inputRef}
            type="text"
            value={searchText}
            onChange={(e) => onSearchChange(e.target.value)}
            onKeyDown={(e) =>
              e.key === "Enter" &&
              results.length === 0 &&
              onCreate(searchText)
            }
            placeholder="Type to search or create..."
            className="flex-1 text-xl font-light outline-none bg-transparent h-10"
          />
          <div className="text-xs text-gray-400 border border-gray-200 px-2 py-1 rounded">
            ESC to close
          </div>
        </div>
        
        <div className="bg-gray-50 max-h-[60vh] overflow-y-auto">
          {isSearching ? (
            <div className="p-8 text-center text-gray-400">Searching...</div>
          ) : (
            <>
              {/* Create New Button */}
              {searchText && !hasExactMatch && (
                <div
                  className="p-4 bg-indigo-50 border-b border-indigo-100 flex justify-between items-center group cursor-pointer hover:bg-indigo-100 transition-colors"
                  onClick={() => onCreate(searchText)}
                >
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 rounded-full bg-indigo-200 text-indigo-700 flex items-center justify-center font-bold text-xl">
                      +
                    </div>
                    <div>
                      <div className="font-bold text-indigo-800">
                        Create "{searchText}"
                      </div>
                      <div className="text-xs text-indigo-500">
                        Auto-fill meaning & pronunciation
                      </div>
                    </div>
                  </div>
                  <span className="text-sm font-semibold text-indigo-600 bg-white px-3 py-1 rounded-full shadow-sm">
                    Enter ‚Üµ
                  </span>
                </div>
              )}

              {/* Results List */}
              {results.length > 0 ? (
                <ul className="divide-y divide-gray-100">
                  {results.map((item) => (
                    <li
                      key={item.id}
                      onClick={() => onSelect(item)}
                      className="p-3 hover:bg-indigo-50 cursor-pointer transition-colors group"
                    >
                      <div className="flex justify-between items-start gap-3">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-1">
                            <span className="font-bold text-lg text-indigo-700">
                              {item.word}
                            </span>
                            
                            {/* Actions nh·ªè trong list */}
                            <button
                              onClick={(e) => onOpenAssessment(item, e)}
                              className="text-gray-400 hover:text-green-600 p-1 rounded-full hover:bg-green-100"
                            >
                              üé§
                            </button>
                            <button
                              onClick={(e) => onSpeak(item.word, e)}
                              className="text-gray-400 hover:text-indigo-600 p-1 rounded-full hover:bg-indigo-100"
                            >
                              üîä
                            </button>
                            
                            {item.partOfSpeech && (
                              <span className="text-[10px] uppercase font-bold text-indigo-500 bg-indigo-50 border border-indigo-100 px-1.5 py-0.5 rounded">
                                {item.partOfSpeech}
                              </span>
                            )}
                          </div>
                          <div className="text-sm text-gray-800 line-clamp-2">
                            {item.meaning || <span className="italic text-gray-400">No meaning</span>}
                          </div>
                        </div>
                        
                        {/* Meta info b√™n ph·∫£i */}
                        <div className="text-right shrink-0 flex flex-col items-end gap-1">
                          {item.topic && (
                            <span className="text-[10px] text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full">
                              {item.topic}
                            </span>
                          )}
                          {item.isStarred && <span className="text-yellow-400 text-xs">‚òÖ</span>}
                        </div>
                      </div>
                    </li>
                  ))}
                </ul>
              ) : (
                !hasExactMatch &&
                searchText && (
                  <div className="p-4 text-center text-gray-400 text-sm">
                    No existing words match.
                  </div>
                )
              )}
            </>
          )}
        </div>
      </div>
    </div>
  );
}


================================================
FILE: apps/frontend/components/vocabulary/VocabFormModal.tsx
================================================
import React, { useState, useEffect } from "react";
import axios from "axios";
import { MicrophoneIcon, SpeakerIcon } from "@/components/Icons";

interface VocabFormData {
  word: string;
  meaning: string;
  example: string;
  topic: string;
  partOfSpeech: string;
  relatedWords: string;
  pronunciation: string;
}

interface Props {
  isOpen: boolean;
  onClose: () => void;
  initialData: VocabFormData;
  isEditMode: boolean;
  onSave: (data: VocabFormData) => void;
  // Removed onDelete
  onSpeak: (text: string) => void;
  onRecord: (tempData: VocabFormData) => void;
}

export default function VocabFormModal({
  isOpen, onClose, initialData, isEditMode, onSave, onSpeak, onRecord
}: Props) {
  const [formData, setFormData] = useState<VocabFormData>(initialData);
  const [isAutoFilling, setIsAutoFilling] = useState(false);

  useEffect(() => {
    setFormData(initialData);
  }, [initialData]);

  if (!isOpen) return null;

  const fetchAutoFillData = async (word: string) => {
    if (!word) return;
    setIsAutoFilling(true);
    try {
      const [dictRes, transRes] = await Promise.all([
        axios.get(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`).catch(() => null),
        axios.get(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=vi&dt=t&q=${encodeURIComponent(word)}`).catch(() => null),
      ]);
      let newData: Partial<VocabFormData> = {};

      // Parse Dictionary
      if (dictRes?.data?.[0]) {
        const entry = dictRes.data[0];
        newData.pronunciation = entry.phonetic || entry.phonetics?.find((x: any) => x.text && x.audio)?.text;
        if (entry.meanings?.[0]) {
          newData.partOfSpeech = entry.meanings[0].partOfSpeech;
          newData.example = entry.meanings[0].definitions?.find((d: any) => d.example)?.example;
        }
      }

      // Parse Translate
      if (transRes?.data?.[0]) {
        newData.meaning = transRes.data[0].map((item: any) => item[0]).join("");
      }

      setFormData((prev) => ({ ...prev, ...newData }));
    } catch (e) {
      console.error(e);
    } finally {
      setIsAutoFilling(false);
    }
  };

  return (
    <div className="fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4 backdrop-blur-sm" onClick={onClose}>
      <div className="bg-white w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]" onClick={(e) => e.stopPropagation()}>
        {/* Header */}
        <div className="bg-indigo-600 p-6 text-white flex justify-between items-start shrink-0">
          <div className="w-full">
            <div className="text-xs uppercase tracking-wider opacity-80 mb-2">
               {isEditMode ? "Editing Vocabulary" : "Create New Vocabulary"}
            </div>
            <div className="flex items-center gap-3 w-full">
              <input
                value={formData.word}
                onChange={(e) => setFormData({ ...formData, word: e.target.value })}
                onBlur={() => !isEditMode && fetchAutoFillData(formData.word)}
                className="bg-transparent text-4xl font-bold text-white placeholder-white/50 outline-none w-full border-b border-white/20 pb-1 focus:border-white transition-colors"
                placeholder="Word..."
                autoFocus={!isEditMode}
              />
              {isAutoFilling && <div className="text-xs text-indigo-200 animate-pulse ml-2 whitespace-nowrap">√¢≈ì¬® Filling...</div>}
              
              {formData.word && (
                <>
                  <button onClick={() => onRecord(formData)} className="p-2 bg-white/20 rounded-full hover:bg-green-500 text-white transition-colors">
                    <MicrophoneIcon className="w-6 h-6" />
                  </button>
                  <button onClick={() => onSpeak(formData.word)} className="p-2 bg-white/20 rounded-full hover:bg-white/30 text-white">
                    <SpeakerIcon className="w-6 h-6" />
                  </button>
                </>
              )}
            </div>
          </div>
          <button onClick={onClose} className="text-white/70 hover:text-white text-2xl font-bold ml-4">√¢≈ì‚Ä¢</button>
        </div>

        {/* Body */}
        <div className="p-6 space-y-5 overflow-y-auto relative">
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Pronunciation</label>
              <input value={formData.pronunciation} onChange={(e) => setFormData({ ...formData, pronunciation: e.target.value })} className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none font-mono text-sm" placeholder="/.../" />
            </div>
            <div>
              <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Part Of Speech</label>
              <select value={formData.partOfSpeech} onChange={(e) => setFormData({ ...formData, partOfSpeech: e.target.value })} className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none bg-white">
                <option value="">-- Select --</option>
                <option value="noun">Noun</option>
                <option value="verb">Verb</option>
                <option value="adjective">Adjective</option>
                <option value="adverb">Adverb</option>
                <option value="phrase">Phrase</option>
              </select>
            </div>
          </div>
          <div>
            <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Meaning</label>
            <textarea value={formData.meaning} onChange={(e) => setFormData({ ...formData, meaning: e.target.value })} className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none min-h-[80px] text-lg font-medium text-gray-800" placeholder="Ngh√Ñ¬©a c√°¬ª¬ßa t√°¬ª¬´..." />
          </div>
          <div>
            <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Example</label>
            <textarea value={formData.example} onChange={(e) => setFormData({ ...formData, example: e.target.value })} className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none bg-gray-50 italic text-gray-600" placeholder="V√É¬≠ d√°¬ª¬•..." />
          </div>
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Topic</label>
              <input value={formData.topic} onChange={(e) => setFormData({ ...formData, topic: e.target.value })} className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="Topic..." />
            </div>
            <div>
              <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Related Words</label>
              <input value={formData.relatedWords} onChange={(e) => setFormData({ ...formData, relatedWords: e.target.value })} className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="Synonyms..." />
            </div>
          </div>
        </div>

        {/* Footer */}
        <div className="bg-gray-50 p-4 border-t border-gray-200 flex justify-end gap-3 shrink-0">
          <button onClick={onClose} className="text-gray-600 hover:bg-gray-200 px-5 py-2 rounded-lg text-sm font-medium transition-colors">Cancel</button>
          <button onClick={() => onSave(formData)} className="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg text-sm font-bold shadow-md transform active:scale-95 transition-all">
            {isEditMode ? "Save Changes" : "Create Word"}
          </button>
        </div>
      </div>
    </div>
  );
}


================================================
FILE: apps/frontend/components/vocabulary/VocabTable.tsx
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x90 in position 8588: character maps to <undefined>


================================================
FILE: apps/frontend/contexts/AuthContext.tsx
================================================
'use client';

import React, { createContext, useContext, useState, useEffect } from 'react';
import axios from 'axios';

interface User {
  id: string;
  email: string;
  name: string;
  avatar?: string;
}

interface AuthContextType {
  user: User | null;
  token: string | null;
  login: (email: string, password: string) => Promise<void>;
  register: (email: string, password: string, name?: string) => Promise<void>;
  logout: () => void;
  isLoading: boolean;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [token, setToken] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  // Load token from localStorage on mount
  useEffect(() => {
    const savedToken = localStorage.getItem('token');
    if (savedToken) {
      setToken(savedToken);
      fetchUser(savedToken);
    } else {
      setIsLoading(false);
    }
  }, []);

  // Fetch user info
  const fetchUser = async (authToken: string) => {
    try {
      const response = await axios.get('http://localhost:5000/auth/me', {
        headers: { Authorization: `Bearer ${authToken}` },
      });
      setUser(response.data);
    } catch (error) {
      console.error('Failed to fetch user:', error);
      localStorage.removeItem('token');
      setToken(null);
    } finally {
      setIsLoading(false);
    }
  };

  // Login
  const login = async (email: string, password: string) => {
    const response = await axios.post('http://localhost:5000/auth/login', {
      email,
      password,
    });

    const { token: newToken, user: newUser } = response.data;
    
    localStorage.setItem('token', newToken);
    setToken(newToken);
    setUser(newUser);
  };

  // Register
  const register = async (email: string, password: string, name?: string) => {
    const response = await axios.post('http://localhost:5000/auth/register', {
      email,
      password,
      name,
    });

    const { token: newToken, user: newUser } = response.data;
    
    localStorage.setItem('token', newToken);
    setToken(newToken);
    setUser(newUser);
  };

  // Logout
  const logout = () => {
    localStorage.removeItem('token');
    setToken(null);
    setUser(null);
  };

  return (
    <AuthContext.Provider value={{ user, token, login, register, logout, isLoading }}>
      {children}
    </AuthContext.Provider>
  );
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
}

