{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/code/c2025-12-09-worddd/apps/frontend/lib/api.ts"],"sourcesContent":["// apps/frontend/lib/api.ts\r\nimport axios from 'axios';\r\n\r\n// 1. Láº¥y Ä‘á»‹a chá»‰ tá»« biáº¿n mÃ´i trÆ°á»ng (Æ¯u tiÃªn) hoáº·c máº·c Ä‘á»‹nh vá» Localhost\r\nexport const API_URL = process.env.NEXT_PUBLIC_API_URL || 'https://localhost:5000';\r\n\r\n// 2. Táº¡o má»™t instance axios dÃ¹ng chung cho cáº£ app\r\nconst api = axios.create({\r\n  baseURL: API_URL,\r\n  withCredentials: true, // Tá»± Ä‘á»™ng gá»­i cookie (token) Ä‘i kÃ¨m\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\nexport default api;"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;;AAIJ;AAHvB;;AAGO,MAAM,UAAU,8DAAmC;AAE1D,kDAAkD;AAClD,MAAM,MAAM,mJAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,iBAAiB;IACjB,SAAS;QACP,gBAAgB;IAClB;AACF;uCAEe"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["C:/code/c2025-12-09-worddd/apps/frontend/contexts/AuthContext.tsx"],"sourcesContent":["// apps/frontend/contexts/AuthContext.tsx\r\n'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport api from '@/lib/api'; // Import api\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n  avatar?: string;\r\n  googleApiKey?: string;\r\n  googleCx?: string;\r\n  azureSpeechKey?: string;\r\n  azureSpeechRegion?: string;\r\n  azureTranslatorKey?: string;\r\n  azureTranslatorRegion?: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  token: string | null;\r\n  login: (email: string, password: string) => Promise<void>;\r\n  register: (email: string, password: string, name?: string) => Promise<void>;\r\n  logout: () => void;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // Load token from localStorage or cookie on mount\r\n  useEffect(() => {\r\n    let savedToken = localStorage.getItem('token');\r\n\r\n    // Náº¿u khÃ´ng cÃ³ trong localStorage, thá»­ láº¥y tá»« cookie\r\n    if (!savedToken) {\r\n      const cookies = document.cookie.split(';');\r\n      const tokenCookie = cookies.find(c => c.trim().startsWith('token='));\r\n      if (tokenCookie) {\r\n        savedToken = tokenCookie.split('=')[1];\r\n        // LÆ°u láº¡i vÃ o localStorage Ä‘á»ƒ sync\r\n        localStorage.setItem('token', savedToken);\r\n      }\r\n    }\r\n\r\n    if (savedToken) {\r\n      setToken(savedToken);\r\n      fetchUser(savedToken);\r\n    } else {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch user info\r\n  const fetchUser = async (authToken: string) => {\r\n    try {\r\n      const response = await api.get('/auth/me', {\r\n        headers: { Authorization: `Bearer ${authToken}` },\r\n      });\r\n      setUser(response.data);\r\n    } catch (error) {\r\n      console.error('Failed to fetch user:', error);\r\n      localStorage.removeItem('token');\r\n      // XÃ³a cookie cÅ©\r\n      document.cookie = 'token=; path=/; max-age=0; SameSite=None; Secure';\r\n      setToken(null);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Login\r\n  const login = async (email: string, password: string) => {\r\n    const response = await api.post('/auth/login', {\r\n      email,\r\n      password,\r\n    });\r\n    const { token: newToken, user: newUser } = response.data;\r\n\r\n    localStorage.setItem('token', newToken);\r\n\r\n    // ðŸ‘‡ QUAN TRá»ŒNG: ThÃªm SameSite=None; Secure Ä‘á»ƒ Extension dÃ¹ng Ä‘Æ°á»£c Cookie nÃ y\r\n    document.cookie = `token=${newToken}; path=/; max-age=604800; SameSite=None; Secure`;\r\n\r\n    setToken(newToken);\r\n    setUser(newUser);\r\n  };\r\n\r\n  // Register\r\n  const register = async (email: string, password: string, name?: string) => {\r\n    const response = await api.post('/auth/register', {\r\n      email,\r\n      password,\r\n      name,\r\n    });\r\n    const { token: newToken, user: newUser } = response.data;\r\n\r\n    localStorage.setItem('token', newToken);\r\n\r\n    // ðŸ‘‡ QUAN TRá»ŒNG: ThÃªm SameSite=None; Secure\r\n    document.cookie = `token=${newToken}; path=/; max-age=604800; SameSite=None; Secure`;\r\n\r\n    setToken(newToken);\r\n    setUser(newUser);\r\n  };\r\n\r\n  // Logout\r\n  const logout = () => {\r\n    localStorage.removeItem('token');\r\n    // XÃ³a cookie\r\n    document.cookie = 'token=; path=/; max-age=0; SameSite=None; Secure';\r\n    setToken(null);\r\n    setUser(null);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, token, login, register, logout, isLoading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}"],"names":["c","_c","React","createContext","useContext","useState","useEffect","api","User","id","email","name","avatar","googleApiKey","googleCx","azureSpeechKey","azureSpeechRegion","azureTranslatorKey","azureTranslatorRegion","AuthContextType","user","token","login","password","Promise","register","logout","isLoading","AuthContext","undefined","AuthProvider","children","ReactNode","setUser","setToken","setIsLoading","savedToken","localStorage","getItem","cookies","document","cookie","split","tokenCookie","find","trim","startsWith","setItem","fetchUser","authToken","response","get","headers","Authorization","data","error","console","removeItem","post","newToken","newUser","useAuth","$","$i","Symbol","for","context","Error"],"mappings":"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","ignoreList":[]}}]
}