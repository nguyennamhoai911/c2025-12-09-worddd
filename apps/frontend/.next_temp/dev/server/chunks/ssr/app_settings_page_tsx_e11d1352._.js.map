{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/code/c2025-12-09-worddd/apps/frontend/app/settings/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport api from '@/lib/api';\r\n\r\n// Helper Component for Password Input with Toggle\r\nfunction PasswordInput({ value, onChange, name, placeholder = '' }: { value: string, onChange: (e: any) => void, name: string, placeholder?: string }) {\r\n    const [show, setShow] = useState(false);\r\n    return (\r\n        <div className=\"relative\">\r\n            <input\r\n                type={show ? \"text\" : \"password\"}\r\n                name={name}\r\n                value={value}\r\n                onChange={onChange}\r\n                placeholder={placeholder}\r\n                className=\"w-full px-4 py-2 bg-black/20 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition pr-10\"\r\n            />\r\n            <button\r\n                type=\"button\"\r\n                onClick={() => setShow(!show)}\r\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white\"\r\n            >\r\n                {show ? (\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className=\"w-5 h-5\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88\" />\r\n                    </svg>\r\n                ) : (\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className=\"w-5 h-5\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z\" />\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                    </svg>\r\n                )}\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function SettingsPage() {\r\n    const { user, isLoading: authLoading } = useAuth();\r\n    const [loading, setLoading] = useState(false);\r\n    const [success, setSuccess] = useState('');\r\n    const [error, setError] = useState('');\r\n\r\n    const [formData, setFormData] = useState<any>({\r\n        name: '',\r\n        googleApiKey: '',\r\n        googleCx: '',\r\n        azureSpeechKey: '',\r\n        azureSpeechRegion: '',\r\n        azureTranslatorKey: '',\r\n        azureTranslatorRegion: '',\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            setFormData({\r\n                name: user.name || '',\r\n                googleApiKey: user.googleApiKey || '',\r\n                googleCx: user.googleCx || '',\r\n                azureSpeechKey: user.azureSpeechKey || '',\r\n                azureSpeechRegion: user.azureSpeechRegion || '',\r\n                azureTranslatorKey: user.azureTranslatorKey || '',\r\n                azureTranslatorRegion: user.azureTranslatorRegion || '',\r\n            });\r\n        }\r\n    }, [user]);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setSuccess('');\r\n        setError('');\r\n\r\n        try {\r\n            if (!user) return;\r\n            await api.patch(`/users/${user.id}`, formData);\r\n            setSuccess('Cập nhật thành công!');\r\n            // TODO: Could trigger a re-fetch of user here to update context, but ignoring for now\r\n        } catch (err) {\r\n            setError('Có lỗi xảy ra khi cập nhật.');\r\n            console.error(err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (authLoading) return <div className=\"p-8 text-center text-white\">Loading...</div>;\r\n    if (!user) return <div className=\"p-8 text-center text-white\">Vui lòng đăng nhập để xem cài đặt.</div>;\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-black text-white p-6 justify-center flex items-center\">\r\n            <div className=\"w-full max-w-2xl bg-white/10 backdrop-blur-md rounded-2xl p-8 shadow-2xl border border-white/20\">\r\n                <h1 className=\"text-3xl font-bold mb-8 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent\">\r\n                    Cài đặt tài khoản\r\n                </h1>\r\n\r\n                {success && <div className=\"mb-4 p-4 bg-green-500/20 border border-green-500 rounded text-green-200\">{success}</div>}\r\n                {error && <div className=\"mb-4 p-4 bg-red-500/20 border border-red-500 rounded text-red-200\">{error}</div>}\r\n\r\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n\r\n                    <section>\r\n                        <h2 className=\"text-xl font-semibold mb-4 text-purple-300 border-b border-white/10 pb-2\">Thông tin cá nhân</h2>\r\n                        <div className=\"grid gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-300 mb-1\">Email</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={user?.email || ''}\r\n                                    disabled\r\n                                    className=\"w-full px-4 py-2 bg-black/20 border border-white/10 rounded-lg text-gray-400 cursor-not-allowed\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-300 mb-1\">Tên hiển thị</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    name=\"name\"\r\n                                    value={formData.name}\r\n                                    onChange={handleChange}\r\n                                    className=\"w-full px-4 py-2 bg-black/20 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n\r\n                    <section>\r\n                        <h2 className=\"text-xl font-semibold mb-4 text-purple-300 border-b border-white/10 pb-2\">Cấu hình Extension</h2>\r\n                        <p className=\"text-sm text-gray-400 mb-4\">Các thông tin này sẽ được Extension tự động đồng bộ.</p>\r\n\r\n                        <div className=\"space-y-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-300 mb-1 flex items-center justify-between\">\r\n                                    Google API Key\r\n                                    {formData.googleApiKey ? <span className=\"text-xs text-green-400 font-semibold bg-green-900/30 px-2 py-0.5 rounded\">✅ Đã nhập</span> : <span className=\"text-xs text-gray-500\">⚪ Không bắt buộc</span>}\r\n                                </label>\r\n                                <PasswordInput\r\n                                    name=\"googleApiKey\"\r\n                                    value={formData.googleApiKey}\r\n                                    onChange={handleChange}\r\n                                    placeholder=\"AIza...\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-300 mb-1 flex items-center justify-between\">\r\n                                    Google Cx (Search Engine ID)\r\n                                    {formData.googleCx ? <span className=\"text-xs text-green-400 font-semibold bg-green-900/30 px-2 py-0.5 rounded\">✅ Đã nhập</span> : <span className=\"text-xs text-gray-500\">⚪ Không bắt buộc</span>}\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    name=\"googleCx\"\r\n                                    value={formData.googleCx}\r\n                                    onChange={handleChange}\r\n                                    placeholder=\"012345...\"\r\n                                    className=\"w-full px-4 py-2 bg-black/20 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-300 mb-1 flex items-center justify-between\">\r\n                                        Azure Speech Key\r\n                                        {formData.azureSpeechKey ? <span className=\"text-xs text-green-400 font-semibold bg-green-900/30 px-2 py-0.5 rounded\">✅ Đã nhập</span> : <span className=\"text-xs text-gray-500\">⚪ Không bắt buộc</span>}\r\n                                    </label>\r\n                                    <PasswordInput\r\n                                        name=\"azureSpeechKey\"\r\n                                        value={formData.azureSpeechKey}\r\n                                        onChange={handleChange}\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-300 mb-1 flex items-center justify-between\">\r\n                                        Azure Region\r\n                                        {formData.azureSpeechRegion ? <span className=\"text-xs text-green-400 font-semibold bg-green-900/30 px-2 py-0.5 rounded\">✅ Đã nhập</span> : <span className=\"text-xs text-gray-500\">⚪ Không bắt buộc</span>}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        name=\"azureSpeechRegion\"\r\n                                        value={formData.azureSpeechRegion}\r\n                                        onChange={handleChange}\r\n                                        placeholder=\"eastus\"\r\n                                        className=\"w-full px-4 py-2 bg-black/20 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4 mt-4 border-t border-white/10 pt-4\">\r\n                                <div className=\"col-span-2\">\r\n                                    <h3 className=\"text-sm font-semibold text-purple-300 mb-2\">Azure Translator (Thay thế AI Analysis)</h3>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-300 mb-1 flex items-center justify-between\">\r\n                                        Translator Key\r\n                                        {formData.azureTranslatorKey ? <span className=\"text-xs text-green-400 font-semibold bg-green-900/30 px-2 py-0.5 rounded\">✅ Đã nhập</span> : <span className=\"text-xs text-red-300 font-semibold bg-red-900/30 px-2 py-0.5 rounded\">❌ Chưa nhập</span>}\r\n                                    </label>\r\n                                    <PasswordInput\r\n                                        name=\"azureTranslatorKey\"\r\n                                        value={formData.azureTranslatorKey}\r\n                                        onChange={handleChange}\r\n                                        placeholder=\"Key...\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-300 mb-1 flex items-center justify-between\">\r\n                                        Translator Region\r\n                                        {formData.azureTranslatorRegion ? <span className=\"text-xs text-green-400 font-semibold bg-green-900/30 px-2 py-0.5 rounded\">✅ Đã nhập</span> : <span className=\"text-xs text-red-300 font-semibold bg-red-900/30 px-2 py-0.5 rounded\">❌ Chưa nhập</span>}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        name=\"azureTranslatorRegion\"\r\n                                        value={formData.azureTranslatorRegion}\r\n                                        onChange={handleChange}\r\n                                        placeholder=\"southeastasia\"\r\n                                        className=\"w-full px-4 py-2 bg-black/20 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"col-span-2\">\r\n                                    <p className=\"text-xs text-gray-500\">Dùng để dịch văn bản và lấy nghĩa từ vựng (thay thế Gemini).</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={loading}\r\n                        className=\"w-full py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-lg text-white font-semibold shadow-lg transition transform active:scale-95 disabled:opacity-50\"\r\n                    >\r\n                        {loading ? 'Đang lưu...' : 'Lưu cài đặt'}\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,kDAAkD;AAClD,SAAS,cAAc,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,EAAqF;IACjJ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBACG,MAAM,OAAO,SAAS;gBACtB,MAAM;gBACN,OAAO;gBACP,UAAU;gBACV,aAAa;gBACb,WAAU;;;;;;0BAEd,8OAAC;gBACG,MAAK;gBACL,SAAS,IAAM,QAAQ,CAAC;gBACxB,WAAU;0BAET,qBACG,8OAAC;oBAAI,OAAM;oBAA6B,MAAK;oBAAO,SAAQ;oBAAY,aAAa;oBAAK,QAAO;oBAAe,WAAU;8BACtH,cAAA,8OAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,GAAE;;;;;;;;;;yCAGzD,8OAAC;oBAAI,OAAM;oBAA6B,MAAK;oBAAO,SAAQ;oBAAY,aAAa;oBAAK,QAAO;oBAAe,WAAU;;sCACtH,8OAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,GAAE;;;;;;sCACrD,8OAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,GAAE;;;;;;;;;;;;;;;;;;;;;;;AAM7E;AAEe,SAAS;IACpB,MAAM,EAAE,IAAI,EAAE,WAAW,WAAW,EAAE,GAAG,IAAA,mIAAO;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IAEnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAM;QAC1C,MAAM;QACN,cAAc;QACd,UAAU;QACV,gBAAgB;QAChB,mBAAmB;QACnB,oBAAoB;QACpB,uBAAuB;IAC3B;IAEA,IAAA,kNAAS,EAAC;QACN,IAAI,MAAM;YACN,YAAY;gBACR,MAAM,KAAK,IAAI,IAAI;gBACnB,cAAc,KAAK,YAAY,IAAI;gBACnC,UAAU,KAAK,QAAQ,IAAI;gBAC3B,gBAAgB,KAAK,cAAc,IAAI;gBACvC,mBAAmB,KAAK,iBAAiB,IAAI;gBAC7C,oBAAoB,KAAK,kBAAkB,IAAI;gBAC/C,uBAAuB,KAAK,qBAAqB,IAAI;YACzD;QACJ;IACJ,GAAG;QAAC;KAAK;IAET,MAAM,eAAe,CAAC;QAClB,YAAY;YAAE,GAAG,QAAQ;YAAE,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,CAAC,KAAK;QAAC;IAC/D;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QACX,WAAW;QACX,SAAS;QAET,IAAI;YACA,IAAI,CAAC,MAAM;YACX,MAAM,qHAAG,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE;YACrC,WAAW;QACX,sFAAsF;QAC1F,EAAE,OAAO,KAAK;YACV,SAAS;YACT,QAAQ,KAAK,CAAC;QAClB,SAAU;YACN,WAAW;QACf;IACJ;IAEA,IAAI,aAAa,qBAAO,8OAAC;QAAI,WAAU;kBAA6B;;;;;;IACpE,IAAI,CAAC,MAAM,qBAAO,8OAAC;QAAI,WAAU;kBAA6B;;;;;;IAE9D,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;;8BACX,8OAAC;oBAAG,WAAU;8BAAqG;;;;;;gBAIlH,yBAAW,8OAAC;oBAAI,WAAU;8BAA2E;;;;;;gBACrG,uBAAS,8OAAC;oBAAI,WAAU;8BAAqE;;;;;;8BAE9F,8OAAC;oBAAK,UAAU;oBAAc,WAAU;;sCAEpC,8OAAC;;8CACG,8OAAC;oCAAG,WAAU;8CAA2E;;;;;;8CACzF,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;;8DACG,8OAAC;oDAAM,WAAU;8DAA+C;;;;;;8DAChE,8OAAC;oDACG,MAAK;oDACL,OAAO,MAAM,SAAS;oDACtB,QAAQ;oDACR,WAAU;;;;;;;;;;;;sDAGlB,8OAAC;;8DACG,8OAAC;oDAAM,WAAU;8DAA+C;;;;;;8DAChE,8OAAC;oDACG,MAAK;oDACL,MAAK;oDACL,OAAO,SAAS,IAAI;oDACpB,UAAU;oDACV,WAAU;;;;;;;;;;;;;;;;;;;;;;;;sCAM1B,8OAAC;;8CACG,8OAAC;oCAAG,WAAU;8CAA2E;;;;;;8CACzF,8OAAC;oCAAE,WAAU;8CAA6B;;;;;;8CAE1C,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;;8DACG,8OAAC;oDAAM,WAAU;;wDAAiF;wDAE7F,SAAS,YAAY,iBAAG,8OAAC;4DAAK,WAAU;sEAA2E;;;;;iFAAmB,8OAAC;4DAAK,WAAU;sEAAwB;;;;;;;;;;;;8DAEnL,8OAAC;oDACG,MAAK;oDACL,OAAO,SAAS,YAAY;oDAC5B,UAAU;oDACV,aAAY;;;;;;;;;;;;sDAGpB,8OAAC;;8DACG,8OAAC;oDAAM,WAAU;;wDAAiF;wDAE7F,SAAS,QAAQ,iBAAG,8OAAC;4DAAK,WAAU;sEAA2E;;;;;iFAAmB,8OAAC;4DAAK,WAAU;sEAAwB;;;;;;;;;;;;8DAE/K,8OAAC;oDACG,MAAK;oDACL,MAAK;oDACL,OAAO,SAAS,QAAQ;oDACxB,UAAU;oDACV,aAAY;oDACZ,WAAU;;;;;;;;;;;;sDAIlB,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;;sEACG,8OAAC;4DAAM,WAAU;;gEAAiF;gEAE7F,SAAS,cAAc,iBAAG,8OAAC;oEAAK,WAAU;8EAA2E;;;;;yFAAmB,8OAAC;oEAAK,WAAU;8EAAwB;;;;;;;;;;;;sEAErL,8OAAC;4DACG,MAAK;4DACL,OAAO,SAAS,cAAc;4DAC9B,UAAU;;;;;;;;;;;;8DAGlB,8OAAC;;sEACG,8OAAC;4DAAM,WAAU;;gEAAiF;gEAE7F,SAAS,iBAAiB,iBAAG,8OAAC;oEAAK,WAAU;8EAA2E;;;;;yFAAmB,8OAAC;oEAAK,WAAU;8EAAwB;;;;;;;;;;;;sEAExL,8OAAC;4DACG,MAAK;4DACL,MAAK;4DACL,OAAO,SAAS,iBAAiB;4DACjC,UAAU;4DACV,aAAY;4DACZ,WAAU;;;;;;;;;;;;;;;;;;sDAKtB,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;oDAAI,WAAU;8DACX,cAAA,8OAAC;wDAAG,WAAU;kEAA6C;;;;;;;;;;;8DAE/D,8OAAC;;sEACG,8OAAC;4DAAM,WAAU;;gEAAiF;gEAE7F,SAAS,kBAAkB,iBAAG,8OAAC;oEAAK,WAAU;8EAA2E;;;;;yFAAmB,8OAAC;oEAAK,WAAU;8EAAuE;;;;;;;;;;;;sEAExO,8OAAC;4DACG,MAAK;4DACL,OAAO,SAAS,kBAAkB;4DAClC,UAAU;4DACV,aAAY;;;;;;;;;;;;8DAGpB,8OAAC;;sEACG,8OAAC;4DAAM,WAAU;;gEAAiF;gEAE7F,SAAS,qBAAqB,iBAAG,8OAAC;oEAAK,WAAU;8EAA2E;;;;;yFAAmB,8OAAC;oEAAK,WAAU;8EAAuE;;;;;;;;;;;;sEAE3O,8OAAC;4DACG,MAAK;4DACL,MAAK;4DACL,OAAO,SAAS,qBAAqB;4DACrC,UAAU;4DACV,aAAY;4DACZ,WAAU;;;;;;;;;;;;8DAGlB,8OAAC;oDAAI,WAAU;8DACX,cAAA,8OAAC;wDAAE,WAAU;kEAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAMrD,8OAAC;4BACG,MAAK;4BACL,UAAU;4BACV,WAAU;sCAET,UAAU,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;AAMnD"}}]
}