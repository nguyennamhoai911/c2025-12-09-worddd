// c2025-12-09-full-app-english\apps\backend\prisma\schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// 1. Báº£ng User (NgÆ°á»i dÃ¹ng)
model User {
  id       String  @id @default(uuid())
  email    String  @unique
  password String? // ğŸ‘ˆ ThÃªm dáº¥u ? Ä‘á»ƒ cho phÃ©p Null (User Google khÃ´ng cÃ³ pass)
  name     String?
  avatar   String? // ğŸ‘ˆ ThÃªm trÆ°á»ng nÃ y Ä‘á»ƒ lÆ°u áº£nh Ä‘áº¡i diá»‡n tá»« Google
  provider String  @default("local") // "local" hoáº·c "google"
  googleId String? @unique // ID riÃªng cá»§a Google tráº£ vá»

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  vocabItems VocabItem[]

  @@map("users")
}

// 2. Báº£ng VocabItem (Tá»« vá»±ng)
// apps/backend/prisma/schema.prisma

model VocabItem {
  id                  String  @id @default(uuid())
  // ğŸ‘‡ THÃŠM DÃ’NG NÃ€Y: LÆ°u lá»‹ch sá»­ Ä‘iá»ƒm sá»‘ (PostgreSQL há»— trá»£ máº£ng Int[])
  pronunciationScores Int[]   @default([])
  // --- CÃC Cá»˜T KHá»šP Vá»šI EXCEL ---
  topic               String? // Topic
  word                String // Word (Báº¯t buá»™c)
  partOfSpeech        String? @map("part_of_speech") // Part of speech
  pronunciation       String? // Pronunciation
  meaning             String? // Meaning
  example             String? // Example
  relatedWords        String? @map("related_words") // Related words
  occurrence          Int?    @default(1)
  isStarred           Boolean @default(false) // ğŸ‘ˆ New field: Máº·c Ä‘á»‹nh lÃ  false, Ä‘Ã¡nh dáº¥u thÃ¬ true

  // --- CÃC Cá»˜T Há»† THá»NG (Báº¯t buá»™c pháº£i giá»¯) ---
  userId String @map("user_id")
  user   User   @relation(fields: [userId], references: [id])

  // Map cá»™t "Time" trong Excel vÃ o createdAt
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // XÃ³a cÃ¡c trÆ°á»ng cÅ© khÃ´ng dÃ¹ng ná»¯a (imageUrl, audioUrl, tags, masteryLevel...)
  // Hoáº·c cá»© Ä‘á»ƒ Ä‘Ã³ náº¿u sau nÃ y muá»‘n dÃ¹ng láº¡i, nhÆ°ng á»Ÿ Ä‘Ã¢y mÃ¬nh xÃ³a cho gá»n theo Ã½ báº¡n.

  @@index([userId])
  @@map("vocab_items")
}
